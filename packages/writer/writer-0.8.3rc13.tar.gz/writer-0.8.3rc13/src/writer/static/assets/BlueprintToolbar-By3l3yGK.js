import{d as I,i as w,a as g,c as S,o as c,e as _,f as l,y as $,z as M,A as V,q as d,s as p,W as f,t as T,_ as j,k as D,aq as q,r as A,O as F,x as R,M as h,a9 as O,b as G,G as J,T as z,Y as W}from"./index-EqsSXNCT.js";import{u as E}from"./useBlueprintRun-BY1rKd0S.js";import{u as K}from"./floating-ui.vue-Dut-ZoDd.js";import{B as L}from"./BaseTransitionSlideFade-Bd4IIrQx.js";const P={class:"BlueprintToolbarBlocksDropdown"},Y={class:"BlueprintToolbarBlocksDropdown__list"},H={class:"BlueprintToolbarBlocksDropdown__list__item__description"},Q={class:"BlueprintToolbarBlocksDropdown__list__item__title"},U=I({__name:"BlueprintToolbarBlocksDropdown",props:{components:{type:Array,required:!0}},emits:{jumpToComponent:u=>typeof u=="string",runBranch:u=>typeof u=="string"},setup(u){const m=u,a=w(g.core);function b(t){const o=a.getComponentDefinition(t.type);return(o==null?void 0:o.name)??t.type}function B(t){if(t.type!=="blueprints_uieventtrigger"||!!t.content.defaultResult)return!0;const s=(t.outs??[]).map(n=>a.getComponentById(n.toNodeId)).flatMap(n=>Object.values(n.content??{}));return s.length===0?!0:!s.some(n=>n.includes("@{result}"))}const v=S(()=>m.components.map(t=>{var n;const o=a.getComponentDefinition(t.type),s=((n=t.content)==null?void 0:n.alias)||b(t),i=(o==null?void 0:o.name)??t.type;return{id:t.id,disabled:!B(t),title:s,description:i}}));return(t,o)=>(c(),_("div",P,[o[2]||(o[2]=l("p",{class:"BlueprintToolbarBlocksDropdown__header"}," Start blueprint from ",-1)),l("div",Y,[(c(!0),_($,null,M(v.value,s=>(c(),_("div",{key:s.id,class:V(["BlueprintToolbarBlocksDropdown__list__item",{"BlueprintToolbarBlocksDropdown__list__item--disabled":s.disabled}])},[d(f,{variant:"primary",size:"smallIcon","custom-size":"20px",disabled:s.disabled,"data-writer-tooltip":s.disabled?"Can not run without a default result. Go to this block to define a default result.":"Run the branch",onClick:i=>t.$emit("runBranch",s.id)},{default:p(()=>o[0]||(o[0]=[l("i",{class:"material-symbols-outlined"},"play_arrow",-1)])),_:2},1032,["disabled","data-writer-tooltip","onClick"]),l("div",null,[l("p",H,T(s.description),1),l("p",Q,T(s.title),1)]),d(f,{variant:"neutral",size:"smallIcon","custom-size":"20px","data-writer-tooltip":"Jump to the blueprint",onClick:i=>t.$emit("jumpToComponent",s.id)},{default:p(()=>o[1]||(o[1]=[l("i",{class:"material-symbols-outlined"},"jump_to_element",-1)])),_:2},1032,["onClick"])],2))),128))])]))}}),X=j(U,[["__scopeId","data-v-de07d20e"]]),Z={ref:"seeBlueprintsBtn",class:"BlueprintToolbar__btn"},ee={class:"material-symbols-outlined"},te=I({__name:"BlueprintToolbar",emits:{autogenClick:()=>!0},setup(u){const m=w(g.core),a=w(g.builderManager),b=w(g.componentId),B=D("root"),v=D("dropdown"),{run:t,isRunning:o}=E(m,b),{floatingStyles:s}=K(B,v,{placement:"bottom-end",middleware:[q(12)]}),i=S(()=>m.getComponents(b).filter(r=>{var e;return((e=m.getComponentDefinition(r.type))==null?void 0:e.category)==="Triggers"})),n=A(!1),y=F([]);function x(){var r;if(n.value=!n.value,n.value)y.value=W(a.selection.value),a.setSelection(null);else if((r=y.value)!=null&&r.length){a.setSelection(null);for(const e of y.value)a.appendSelection(e.componentId,e.instancePath,e.source);y.value=[]}}function N(r){a.setSelection(r,void 0,"click"),n.value=!1}async function k(r){n.value=!1,await t(r)}return(r,e)=>(c(),_("div",{ref_key:"root",ref:B,class:"BlueprintToolbar","data-writer-unselectable":!0},[d(f,{variant:"secondary","data-automation-action":"run-autogen",onClick:e[0]||(e[0]=C=>r.$emit("autogenClick"))},{default:p(()=>e[3]||(e[3]=[l("i",{class:"material-symbols-outlined"},"bolt",-1),R(" Autogen ")])),_:1}),l("div",Z,[d(f,{variant:"secondary",size:"small","data-automation-action":"run-blueprint",class:"BlueprintToolbar__btn__runBlueprint",onClick:e[1]||(e[1]=O(C=>k(),["stop"]))},{default:p(()=>[e[4]||(e[4]=l("i",{class:"material-symbols-outlined"},"play_arrow",-1)),R(" "+T(h(o)?"Running...":"Run blueprint"),1)]),_:1}),i.value.length>0?(c(),_($,{key:0},[e[5]||(e[5]=l("hr",{class:"BlueprintToolbar__btn__divider"},null,-1)),d(f,{class:"BlueprintToolbar__btn__dropdownTrigger",variant:"secondary",size:"smallIcon","custom-size":"20px",onClickCapture:x},{default:p(()=>[l("i",ee,T(n.value?"arrow_drop_up":"arrow_drop_down"),1)]),_:1}),d(L,null,{default:p(()=>[n.value?(c(),G(X,{key:0,ref_key:"dropdown",ref:v,style:J(h(s)),components:i.value,onJumpToComponent:N,onRunBranch:e[2]||(e[2]=C=>k(C))},null,8,["style","components"])):z("",!0)]),_:1})],64)):z("",!0)],512)],512))}}),re=j(te,[["__scopeId","data-v-78878259"]]);export{re as default};
