{"version":3,"file":"lib_index_js.1ef259227089b24bd7d7.js","mappings":"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","sources":["webpack://quapp-jupyterlab-s3-bridge/./src/index.ts"],"sourcesContent":["import {\n  JupyterFrontEnd,\n  JupyterFrontEndPlugin\n} from '@jupyterlab/application';\nimport { IFileBrowserFactory, FileBrowser } from '@jupyterlab/filebrowser';\nimport { ToolbarButton, saveIcon } from '@jupyterlab/ui-components';\nimport { ISettingRegistry } from '@jupyterlab/settingregistry';\nimport { Widget, PanelLayout } from '@lumino/widgets';\nimport { URLExt } from '@jupyterlab/coreutils';\nimport { ServerConnection } from '@jupyterlab/services';\n\n/**\n * Widget chứa dropdown list hiển thị version.\n * Khi tải, gọi GET /s3bridge/versions để lấy danh sách phiên bản.\n * Và khi có sự thay đổi, gọi PATCH /s3bridge/versions/<selected_version> để cập nhật file list.\n */\nclass VersionsDropdownWidget extends Widget {\n  private _select: HTMLSelectElement;\n\n  constructor() {\n    super();\n    this.addClass('versions-dropdown-widget');\n    this._select = document.createElement('select');\n    this._select.style.margin = '0 4px';\n    this._select.style.width = '150px';\n    this.node.appendChild(this._select);\n    this.loadVersions();\n\n    // Sự kiện khi lựa chọn phiên bản thay đổi\n    this._select.addEventListener(\"change\", async () => {\n      const selectedVersion = this.selectedVersion;\n      console.log(`Version changed: ${selectedVersion}`);\n      try {\n        const settings = ServerConnection.makeSettings();\n        // Gọi PATCH đến /s3bridge/versions/<selectedVersion>\n        const url = URLExt.join(settings.baseUrl, 's3bridge', 'versions', selectedVersion);\n        const response = await fetch(url, { method: 'PATCH', credentials: 'include' });\n        if (!response.ok) {\n          const errData = await response.json();\n          throw new Error(`Update error: ${response.status} => ${errData.error || ''}`);\n        }\n        const result = await response.json();\n        console.log(\"Version update successful:\", result);\n        // Sau khi cập nhật file list thành công, refresh lại dropdown\n        await this.loadVersions();\n      } catch (error) {\n        console.error(\"Error updating version:\", error);\n      }\n    });\n  }\n\n  async loadVersions(): Promise<void> {\n    try {\n      const settings = ServerConnection.makeSettings();\n      const url = URLExt.join(settings.baseUrl, 's3bridge', 'versions');\n      const response = await fetch(url, { method: 'GET', credentials: 'include' });\n      if (!response.ok) {\n        throw new Error(`Failed to load versions: ${response.status}`);\n      }\n      const result = await response.json();\n      const versionsData = result.data as Array<any>;\n      const versionNumbers = versionsData.map(item => Number(item.version));\n      versionNumbers.sort((a, b) => a - b);\n      this._select.innerHTML = \"\";\n      versionNumbers.forEach(v => {\n        const option = document.createElement('option');\n        option.value = v.toString();\n        option.textContent = `v${v}`;\n        this._select.appendChild(option);\n      });\n      if (versionNumbers.length > 0) {\n        // Chọn phiên bản mới nhất làm mặc định\n        this._select.value = versionNumbers[versionNumbers.length - 1].toString();\n      }\n      console.log(\"Loaded versions from server:\", versionNumbers);\n    } catch (error) {\n      console.error(\"Error loading versions:\", error);\n    }\n  }\n\n  get selectedVersion(): string {\n    return this._select.value;\n  }\n}\n\n/**\n * Tạo toolbar chứa label \"Version:\" và dropdown list.\n */\nfunction createVersionToolbar(): Widget {\n  const versionToolbar = new Widget();\n  versionToolbar.addClass('jp-FileBrowser-version-toolbar');\n  versionToolbar.node.style.display = 'flex';\n  versionToolbar.node.style.alignItems = 'center';\n  versionToolbar.node.style.padding = '2px 4px';\n  versionToolbar.node.style.borderTop = '1px solid var(--jp-border-color2)';\n\n  const label = document.createElement('span');\n  label.textContent = 'Version:';\n  label.style.marginLeft = '8px';\n  label.style.marginRight = '4px';\n\n  const dropdown = new VersionsDropdownWidget();\n  versionToolbar.node.appendChild(label);\n  versionToolbar.node.appendChild(dropdown.node);\n  return versionToolbar;\n}\n\n/**\n * Hàm chèn nút \"Save to S3\" vào toolbar của FileBrowser.\n * Sau khi upload thành công, phát event refresh để làm mới dropdown.\n */\nfunction addSaveButton(browser: FileBrowser): void {\n  console.log('Adding Save to S3 button to FileBrowser:', browser.id);\n\n  const saveButton = new ToolbarButton({\n    icon: saveIcon,\n    tooltip: 'Push local changes to S3 backend',\n    onClick: async () => {\n      console.log('Save to S3 button clicked');\n      try {\n        const settings = ServerConnection.makeSettings();\n        const url = URLExt.join(settings.baseUrl, 's3bridge', 'upload-s3');\n        const resp = await fetch(url, { method: 'POST', credentials: 'include' });\n        if (!resp.ok) {\n          const errData = await resp.json();\n          throw new Error(`Upload error: ${resp.status} => ${errData.error || ''}`);\n        }\n        const data = await resp.json();\n        alert('Upload success: ' + JSON.stringify(data));\n        // Phát sự kiện để refresh dropdown phiên bản\n        document.dispatchEvent(new CustomEvent(\"refreshVersionDropdown\"));\n      } catch (err) {\n        console.error(err);\n        alert('Upload failed: ' + err);\n      }\n    }\n  });\n  saveButton.node.id = 'saveS3Button';\n\n  setTimeout(() => {\n    if (browser.toolbar) {\n      if (!browser.toolbar.node.querySelector('#saveS3Button')) {\n        try {\n          browser.toolbar.insertItem(1, 'saveS3', saveButton);\n          console.log('Save to S3 button inserted at index 1 in', browser.id);\n        } catch (error) {\n          console.warn('insertItem failed, trying addItem instead:', error);\n          browser.toolbar.addItem('saveS3', saveButton);\n        }\n      } else {\n        console.log('Save to S3 button already exists in', browser.id);\n      }\n    } else {\n      console.warn('Toolbar not ready for', browser.id);\n    }\n  }, 200);\n}\n\n/**\n * Hàm chèn hàng toolbar chứa dropdown version vào layout của FileBrowser.\n * Lắng nghe sự kiện \"refreshVersionDropdown\" để làm mới dropdown.\n */\nfunction addVersionToolbar(browser: FileBrowser): void {\n  console.log('Adding version dropdown toolbar to FileBrowser:', browser.id);\n  const layout = browser.layout as PanelLayout;\n  if (!layout) {\n    console.warn('No layout available for', browser.id);\n    return;\n  }\n  const existing = browser.node.querySelector('.jp-FileBrowser-version-toolbar');\n  if (existing) {\n    console.log('Version toolbar already exists for', browser.id);\n    return;\n  }\n  const versionToolbar = createVersionToolbar();\n  // Lắng nghe event refresh để reload dropdown\n  document.addEventListener(\"refreshVersionDropdown\", async () => {\n    console.log(\"Refreshing version dropdown for\", browser.id);\n    // Giả sử bạn có thể lấy lại tham chiếu widget dropdown thông qua DOM,\n    // ở đây chúng ta reload toàn bộ toolbar bằng cách loại bỏ và chèn lại.\n    versionToolbar.node.innerHTML = \"\";\n    const label = document.createElement('span');\n    label.textContent = 'Version:';\n    label.style.marginLeft = '8px';\n    label.style.marginRight = '4px';\n    versionToolbar.node.appendChild(label);\n    const newDropdown = new VersionsDropdownWidget();\n    versionToolbar.node.appendChild(newDropdown.node);\n  });\n\n  layout.insertWidget(1, versionToolbar);\n  console.log('Version dropdown toolbar inserted in', browser.id);\n}\n\n/**\n * Plugin extension: thêm nút \"Save to S3\" và toolbar chứa dropdown version vào FileBrowser.\n */\nconst plugin: JupyterFrontEndPlugin<void> = {\n  id: 'quapp_jupyterlab_s3_bridge:plugin',\n  description: 'A JupyterLab extension for project Quapp: Save local changes to S3.',\n  autoStart: true,\n  requires: [IFileBrowserFactory],\n  optional: [ISettingRegistry],\n  activate: (\n    app: JupyterFrontEnd,\n    factory: IFileBrowserFactory,\n    settingRegistry: ISettingRegistry | null\n  ) => {\n    console.log('Activating quapp_jupyterlab_s3_bridge extension with dynamic version dropdown');\n\n    if (settingRegistry) {\n      settingRegistry\n        .load(plugin.id)\n        .then(settings => {\n          console.log('Settings loaded:', settings.composite);\n        })\n        .catch(reason => {\n          console.error('Failed to load settings for quapp_jupyterlab_s3_bridge.', reason);\n        });\n    }\n\n    function addToolbarItems(browser: FileBrowser): void {\n      addSaveButton(browser);\n      addVersionToolbar(browser);\n    }\n\n    factory.tracker.forEach((browser: FileBrowser) => {\n      addToolbarItems(browser);\n    });\n\n    factory.tracker.widgetAdded.connect((sender, browser: FileBrowser) => {\n      console.log('New FileBrowser widget added:', browser.id);\n      addToolbarItems(browser);\n    });\n  }\n};\n\nexport default plugin;\n"],"names":[],"sourceRoot":""}