(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[904],{5777:e=>{e.exports={card:"components_card__VzNcC",chartCard:"components_chartCard__7eu6m",cardTable:"components_cardTable__lUWto",cardHeader:"components_cardHeader__B2B_w",cardBody:"components_cardBody__e4ftM",sectionHeader:"components_sectionHeader__FYUwh",chartSectionHeader:"components_chartSectionHeader__saRLs",sectionHeaderFlush:"components_sectionHeaderFlush___lqjQ",sectionTitle:"components_sectionTitle__nLNmP",loading:"components_loading__lEAap",error:"components_error__dilwj",empty:"components_empty__VxnwR",emptyIcon:"components_emptyIcon__qhAE6",startScanButton:"components_startScanButton__gDjkk",outlineButton:"components_outlineButton__jVFc7",table:"components_table__AuvsC",severityHIGH:"components_severityHIGH__bpfgf",severityMEDIUM:"components_severityMEDIUM__14TKl",severityLOW:"components_severityLOW__QKPaC",progress:"components_progress__QOR5t",progressBar:"components_progressBar__cjnZa",info:"components_info__Yr63j",container:"components_container__gZjQa",title:"components_title__Y0b_e",subtitle:"components_subtitle__yXuWs",runsGrid:"components_runsGrid__232Ck",progressGrid:"components_progressGrid__YuuXp",status:"components_status__4Y__B",statusCompleted:"components_statusCompleted__Ic_rK",statusRunning:"components_statusRunning__ESLxQ",statusFailed:"components_statusFailed__JROAB",statusDefault:"components_statusDefault__15l2p",date:"components_date__0M35T",content:"components_content__8tqmD",model:"components_model__hxNfu",message:"components_message__YWo3C",header:"components_header__cKRrY",percentage:"components_percentage__EzTIO",pageHeader:"components_pageHeader__L0qQ9",actions:"components_actions__N8b1C",button:"components_button__RWwep",active:"components_active__BVett",newButton:"components_newButton__dhUFB",buttonColor:"components_buttonColor__0TCSp",buttonColorSolid:"components_buttonColorSolid__wCD7m",newButtonSize:"components_newButtonSize__UKmqX",outlineButtonColor:"components_outlineButtonColor__mWBqP",buttonNoBackground:"components_buttonNoBackground__sI_rX",filterButton:"components_filterButton__Rx7x7",tableContainer:"components_tableContainer__oa9aj",tableBody:"components_tableBody__F7K7c",tableHeader:"components_tableHeader__GD68N",tableRow:"components_tableRow__7MR6t",scansTableHeader:"components_scansTableHeader__od3Uk",scansTableRow:"components_scansTableRow__T6ta_",headerCell:"components_headerCell__Tx5bp",cell:"components_cell__VTCO8",paginationContainer:"components_paginationContainer__Ms5Gf",pageSelector:"components_pageSelector__SbNt4",resultsPerPageContainer:"components_resultsPerPageContainer___49Gc",resultsPerPageSelector:"components_resultsPerPageSelector__J9MSf",deleteButton:"components_deleteButton__i3Bum",finishedBadge:"components_finishedBadge__K7Yjg",initializingBadge:"components_initializingBadge__mIUF0",pausedBadge:"components_pausedBadge__GR0fC",cellStatus:"components_cellStatus__fsisH",resultsButton:"components_resultsButton__ExEWx",datasetGrid:"components_datasetGrid__j2kef",checkboxLabel:"components_checkboxLabel__RXfBK",policyAccordion:"components_policyAccordion__0merH",policySection:"components_policySection__f3YBD",articleSection:"components_articleSection__IRROC",searchBar:"components_searchBar__lprIl",searchInput:"components_searchInput__S_em7",policyList:"components_policyList__sQ6Jp",policyItem:"components_policyItem__hv8Rb",selected:"components_selected__aK9y2",policyInfo:"components_policyInfo__YXDXK",policyDescription:"components_policyDescription__OUIAD",checkbox:"components_checkbox__MY7ZL",datasetItem:"components_datasetItem__u48HE",subcategories:"components_subcategories__sTmW8",subcategory:"components_subcategory__U37qI",modalOverlay:"components_modalOverlay__Uzq6J",modalContent:"components_modalContent__hiw8G",modalContentWide:"components_modalContentWide__7OO2d components_modalContent__hiw8G",closeButton:"components_closeButton__4h_N_",modalActions:"components_modalActions__OvLUR",stepContainer:"components_stepContainer__qYf5e",step:"components_step__U1nAH",stepNumber:"components_stepNumber__7C_Mh",stepContent:"components_stepContent__9pSPx",modalBody:"components_modalBody__M2xrL",modelList:"components_modelList__NvY9v",logo:"components_logo__bpqY_",logoInverted:"components_logoInverted__Cr03Y",modelOption:"components_modelOption__esahM",predefinedModelOption:"components_predefinedModelOption__rNS_j",localModelSection:"components_localModelSection__xnZUe",localModelButton:"components_localModelButton__lWD7U",localModelList:"components_localModelList__407uk",noModelsMessage:"components_noModelsMessage__XseiM",scanNameSection:"components_scanNameSection__BWPGP",scanNameInput:"components_scanNameInput__b5ORa",nextButton:"components_nextButton__opW4b",cancelButton:"components_cancelButton__DeI__",backButton:"components_backButton__RlYVL",selectAllButton:"components_selectAllButton__KRBLs",doneButton:"components_doneButton__DonRN",categoryGrid:"components_categoryGrid__Y71mA",categoryButton:"components_categoryButton__s0nyK",actionButtons:"components_actionButtons__OtBO3",testButton:"components_testButton__8Q1E2",startButton:"components_startButton__nVe9T",splitView:"components_splitView__QfdQk",categoriesContainer:"components_categoriesContainer__G5V0Q",categoriesList:"components_categoriesList__ECX5A",categoryActions:"components_categoryActions__Pi6GG",categoryItem:"components_categoryItem__HyvjI",categoryItemContent:"components_categoryItemContent__Mu4od",subcategoriesPanel:"components_subcategoriesPanel__UqO4Z",subcategoriesContent:"components_subcategoriesContent__JyF23",subcategoryGroup:"components_subcategoryGroup__94fwh",subcategoryTile:"components_subcategoryTile__47HNk",subcategoriesGrid:"components_subcategoriesGrid__WmeSr",subcategoryHeader:"components_subcategoryHeader__rmM8B",subcategoryParent:"components_subcategoryParent___6x1s",expandButton:"components_expandButton__CWoCJ",modelTile:"components_modelTile__TD9f_",modelTileContent:"components_modelTileContent__gPFbU",modelTileIcon:"components_modelTileIcon__Otq_y",modelTileName:"components_modelTileName__L_7dv",modelTileModifyTime:"components_modelTileModifyTime__j9Dn0",modelTileHistoryButton:"components_modelTileHistoryButton__Zjt_j",modelsGrid:"components_modelsGrid__dCE05",progressCardsList:"components_progressCardsList__hWdJ5",progressCardContainer:"components_progressCardContainer__TAcaH",progressCard:"components_progressCard__FUnJY",progressCardContent:"components_progressCardContent__cI3hy",progressCardColumn:"components_progressCardColumn__WhfrV",progressCardField:"components_progressCardField__Axdby",progressCardLabel:"components_progressCardLabel__KmCCR",progressCardValue:"components_progressCardValue__CTHpr",progressCardPlayButton:"components_progressCardPlayButton__2N7aG",pauseButton:"components_pauseButton__JcnCG",playIcon:"components_playIcon__hV_fa",progressBarContainer:"components_progressBarContainer__Uwzl5",progressBarFill:"components_progressBarFill__n24Qf",cloudConfigForm:"components_cloudConfigForm__swQD6",formGroup:"components_formGroup__pfLir",formInput:"components_formInput__8_feE",formTextarea:"components_formTextarea__9cUKX",helpText:"components_helpText__M9oC8",cloudConfigActions:"components_cloudConfigActions__Wjvrq",selectDatasetButton:"components_selectDatasetButton__aemt_",requiredField:"components_requiredField__OHT7G",refreshButton:"components_refreshButton__9OtDm",refreshIcon:"components_refreshIcon__eyJ_n",refreshIconStatic:"components_refreshIconStatic__eNL2z",spinningIcon:"components_spinningIcon___X1Ck",spin:"components_spin__DOsd_",dashboardContainer:"components_dashboardContainer__Gju0r",welcomeCard:"components_welcomeCard__ghlMC",welcomeAvatar:"components_welcomeAvatar__4WDSN",welcomeTitle:"components_welcomeTitle__L8mBd",welcomeSubtitle:"components_welcomeSubtitle__47a4W",statsGrid:"components_statsGrid__mfCNl",statCard:"components_statCard__nXpWt",statIconContainer:"components_statIconContainer__B3YFl",statIcon:"components_statIcon__K0Wer",yellow:"components_yellow__pQa4g",pink:"components_pink__mlnjg",purple:"components_purple__MohbY",blue:"components_blue__p7ydO",statInfoText:"components_statInfoText__ePCCu",statValue:"components_statValue__gOmbw",statLabel:"components_statLabel__s3bTV",activitySection:"components_activitySection__UFjUJ",activityHeader:"components_activityHeader__KPYW4",activityTable:"components_activityTable__fcPwY",activityRow:"components_activityRow__irK24",activityTimestamp:"components_activityTimestamp__pZDDf",activityMessage:"components_activityMessage__Uer8e",truncatedMessage:"components_truncatedMessage__QzedI",showMoreLink:"components_showMoreLink__AT8d7",addModelOverlay:"components_addModelOverlay__8OoGt",addModelContent:"components_addModelContent__Er2IO",addModelHeader:"components_addModelHeader__fJSHA",addModelSubtitle:"components_addModelSubtitle__6PYjI",addModelBody:"components_addModelBody__qIsF9",addModelStep:"components_addModelStep__wMwfF",addModelStepNumber:"components_addModelStepNumber__JmfC6",addModelStepIcon:"components_addModelStepIcon__HRDTn",addModelStepTitle:"components_addModelStepTitle__sHMD0",addModelStepDescription:"components_addModelStepDescription__kVmCQ",addModelButtons:"components_addModelButtons__d3DuC",addModelDownloadButton:"components_addModelDownloadButton__bQhL0",addModelActions:"components_addModelActions__Z2wRE",addModelCloseButton:"components_addModelCloseButton__sP3TB",spinnerContainer:"components_spinnerContainer__M7nmr"}},37123:(e,t,n)=>{"use strict";n.d(t,{Q:()=>s});let o=()=>window.__NEXT_PUBLIC_API_URL__||"",s=new Proxy({runs:{datasets:"/datasets/list",refresh:"/datasets/refresh",testchat:"/scan/testchat",list:"/scan/list",progress:"/scan/progress",action:"/api/runs/action",filterRuns:"/scan/list",image:e=>"/scan/images/".concat(e),start:"/scan/start",pause:e=>"/scan/pause/".concat(e),resume:e=>"/scan/resume/".concat(e),delete:e=>"/scan/delete/".concat(e),info:e=>"/scan/info/".concat(e),compare:e=>"/scan/compare_scans/".concat(e),getById:e=>"/api/runs/".concat(e),merge:"/scan/merge",mergeEligible:"/scan/eligible_for_merge"},datasets:{list:"/datasets/list",refresh:"/datasets/refresh"},model:{list:"/scan/models",listAll:"/scan/filter_models",scans:e=>"/scan/list?filter_model=".concat(e),chartData:e=>"/scan/line_charts/".concat(e)},analytics:e=>"/api/analytics/".concat(e),vulnerabilities:{list:"/scan/summary/"},results:e=>"/scan/summary/".concat(e),downloadFailures:e=>"/scan/download_failures/".concat(e),generatePdf:e=>"/scan/generate_pdf/".concat(e),clientAddress:"/getclientaddress",dashboard:{stats:"/dashboard/stats",activities:"/dashboard/activities"},images:{serve:e=>"/api/images/".concat(e)}},{get(e,t){let n=o(),s=e[t];return"object"==typeof s?new Proxy(s,{get(e,t){let o=e[t];return"function"==typeof o?function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return"".concat(n).concat(o(...t))}:"".concat(n).concat(o)}}):"function"==typeof s?function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return"".concat(n).concat(s(...t))}:"".concat(n).concat(s)}})},45063:e=>{e.exports={spinner:"Spinner_spinner__lWskE",spinnerRing:"Spinner_spinnerRing__FAG9d",spin:"Spinner_spin__y94gD"}},48263:(e,t,n)=>{"use strict";n.d(t,{y:()=>c});var o=n(95155);n(12115);var s=n(45063),a=n.n(s);let c=e=>{let{className:t}=e;return(0,o.jsx)("div",{className:"".concat(a().spinner," ").concat(t||""),children:(0,o.jsx)("div",{className:a().spinnerRing})})}},78772:(e,t,n)=>{"use strict";n.d(t,{D:()=>g});var o=n(95155),s=n(12115),a=n(37123),c=n(5777),l=n.n(c),r=n(66766),i=n(90830),_=n.n(i);function d(e){let{isOpen:t,onClose:n,modelName:c,cloudModelName:l,apiKey:r,additionalArgs:i}=e,[d,m]=(0,s.useState)(""),[p,u]=(0,s.useState)(""),[g,h]=(0,s.useState)(!1),[y,C]=(0,s.useState)(""),f=async()=>{if(d.trim()&&c){h(!0),C(""),u("");try{let e={};l&&(e.modelname=l),r&&(e.apikey=r),(null==i?void 0:i.trim())&&i.split("\n").forEach(t=>{let[n,o]=t.split(":").map(e=>e.trim());n&&o&&(e[n]=o)});let t=l?c.replace(".py","_template"):c,n=await fetch(a.Q.runs.testchat,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:[{role:"user",content:d}],extra_args:e,model:t})});if(!n.ok)throw Error("Server error");let o=await n.json();u(o.response||o.message)}catch(e){C("There was a server error"),console.error("Test prompt error:",e)}finally{h(!1)}}};return t?(0,o.jsx)("div",{className:_().overlay,children:(0,o.jsxs)("div",{className:_().dialog,children:[(0,o.jsx)("h2",{children:"Test Model Response"}),(0,o.jsx)("textarea",{className:_().promptInput,value:d,onChange:e=>m(e.target.value),placeholder:"Enter your custom prompt here",rows:6}),y&&(0,o.jsx)("div",{className:_().error,children:y}),p&&(0,o.jsx)("div",{className:_().response,children:p}),(0,o.jsxs)("div",{className:_().buttons,children:[(0,o.jsx)("button",{className:_().testButton,onClick:f,disabled:g,children:g?"Testing...":"Test Prompt"}),(0,o.jsx)("button",{className:_().backButton,onClick:n,disabled:g,children:"Back"})]})]})}):null}var m=n(87714),p=n.n(m);function u(e){let{isOpen:t,onClose:n,onComplete:s,message:a}=e;return t?(0,o.jsx)("div",{className:p().overlay,children:(0,o.jsxs)("div",{className:p().dialog,children:[(0,o.jsx)("h2",{children:"Scan Status"}),(0,o.jsx)("div",{className:p().message,children:a}),(0,o.jsx)("button",{className:p().closeButton,onClick:()=>{n(),s()},children:"Close"})]})}):null}function g(e){var t,n;let{isOpen:c,onClose:i}=e,[_,m]=(0,s.useState)(1),[p,g]=(0,s.useState)({scanName:"",selectedCategories:[],selectedItems:{}}),[h,y]=(0,s.useState)([]),[C,f]=(0,s.useState)(!1),[b,x]=(0,s.useState)(!1),[v,N]=(0,s.useState)([]),[j,B]=(0,s.useState)(""),[T,S]=(0,s.useState)({}),[I,M]=(0,s.useState)([]),[w,k]=(0,s.useState)(!1),[L,A]=(0,s.useState)(!1),[O,R]=(0,s.useState)(""),[D,E]=(0,s.useState)(""),[F,H]=(0,s.useState)(""),[P,G]=(0,s.useState)(""),[Q,U]=(0,s.useState)(!1),[W,K]=(0,s.useState)(!1),[Y,q]=(0,s.useState)(!1),z=(0,s.useRef)(null),J=(0,s.useRef)(null),V=[{id:"openai",name:"OpenAI"},{id:"google",name:"Google"},{id:"together",name:"Together"},{id:"anthropic",name:"Anthropic"}];(0,s.useEffect)(()=>{c&&(m(1),g({scanName:"",selectedCategories:[],selectedItems:{}}),B(""),M([]),f(!1),E(""),H(""),G(""),N([]),S({}))},[c]),(0,s.useEffect)(()=>{function e(e){J.current&&J.current.contains(e.target)||z.current&&!z.current.contains(e.target)&&f(!1)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);let X=e=>{"local"===p.modelType?g(t=>({...t,modelType:e,modelName:void 0})):p.modelType!==e?(E(""),H(""),G(""),g(t=>({...t,modelType:e}))):g(t=>({...t,modelType:e}))},Z=e=>{E(""),H(""),G(""),g(t=>({...t,modelType:"local",modelName:e})),f(!1)},$=async()=>{if(p.modelType&&p.scanName){if("local"!==p.modelType)return void m(4);try{let e=await fetch(a.Q.runs.datasets),t=await e.json(),n=Object.entries(t).map(e=>{let[t,n]=e;return{name:t,subcategories:n}});N(n),S(t),m(2)}catch(e){console.error("Failed to fetch datasets:",e)}}},ee=e=>{p.selectedCategories.includes(e)||g(t=>({...t,selectedCategories:[...t.selectedCategories,e]})),p.selectedItems[e]||g(t=>({...t,selectedItems:{...t.selectedItems,[e]:{}}})),B(e),m(3),setTimeout(()=>{if(Array.isArray(T[e])&&T[e].length>0){let t=T[e][0];t&&M([t.name])}},0)},et=(e,t)=>{g(n=>{let o=JSON.parse(JSON.stringify(n.selectedItems)),s=T[j].find(e=>I.includes(e.name));if(!s)return n;let a=s.name;o[j]||(o[j]={}),o[j][a]||(o[j][a]=[]);let c=o[j][a];if(c.includes(e)){let n=c.filter(n=>!(n===e||t&&t.includes(n)));o[j][a]=n}else{let n=[...c,e];t&&t.forEach(e=>{n.includes(e)||n.push(e)}),o[j][a]=n}return{...n,selectedItems:o}})},en=()=>{let e={};return Object.entries(p.selectedItems).forEach(t=>{let[n,o]=t;Object.entries(o).forEach(t=>{let[n,o]=t;o&&o.length>0&&(e[n]||(e[n]=[]),o.forEach(t=>{e[n].includes(t)||e[n].push(t)}))})}),Object.entries(e).filter(e=>{let[t,n]=e;return n.length>0}).map(e=>{let[t,n]=e;return{name:t,subcategories:n}})},eo=async()=>{if(W)return;K(!0);let e=setTimeout(()=>{q(!0)},300);try{let e={scan_name:p.scanName,model_name:"local"===p.modelType?p.modelName:"".concat(p.modelType,"_template"),datasets:en(),continue_flag:!1},t={};if("local"!==p.modelType){let e={};P.trim()&&P.split("\n").forEach(t=>{let[n,o]=t.split(":").map(e=>e.trim());n&&o&&(e[n]=o)}),t={modelname:D,apikey:F,...e}}let n="local"===p.modelType?{...e,extra_args:{}}:{...e,extra_args:t};if(!(await fetch(a.Q.runs.start,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).ok)throw Error("Failed to start scan");e_(),i(!0)}catch(e){console.error("Failed to start scan:",e),R("Failed to start scan. Please try again."),A(!0)}finally{clearTimeout(e),q(!1),K(!1)}},es=e=>{M([e])},ea=e=>{M(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},ec=e=>{var t,n,o;if(!(null==(t=p.selectedItems[j])?void 0:t[e]))return!1;let s=null==(n=T[j])?void 0:n.find(t=>t.name===e);if(!s)return!1;let a=[e];null==(o=s.subcategories)||o.forEach(e=>{a.push(e.name),e.items&&a.push(...e.items)});let c=p.selectedItems[j][e];return a.every(e=>c.includes(e))},el=()=>!!p.selectedItems[j]&&Array.isArray(T[j])&&T[j].every(e=>ec(e.name)),er=function(e){var t,n;let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=null==(t=T[j])?void 0:t.find(t=>t.name===e);if(!s)return;let a=[e];null==(n=s.subcategories)||n.forEach(e=>{a.push(e.name),e.items&&a.push(...e.items)}),console.log("handleTopLevelSelect",e),g(t=>{let n=JSON.parse(JSON.stringify(t.selectedItems));return n[j]||(n[j]={}),n[j][e]||(n[j][e]=[]),ec(e)&&!o?n[j][e]=[]:n[j][e]=a,{...t,selectedItems:n}})},ei=e=>p.selectedItems[e]&&Object.values(p.selectedItems[e]).some(e=>e.length>0),e_=()=>{g({scanName:"",selectedCategories:[],selectedItems:{}}),B(""),M([]),f(!1),E(""),H(""),G("")},ed=()=>{e_(),i(!1)},em=async()=>{try{let e=await fetch(a.Q.runs.datasets),t=await e.json(),n=Object.entries(t).map(e=>{let[t,n]=e;return{name:t,subcategories:n}});N(n),S(t),m(2)}catch(e){console.error("Failed to fetch datasets:",e)}},ep=async()=>{if(!Q){U(!0);try{let e=await fetch(a.Q.datasets.refresh);if(!e.ok)throw Error("Failed to refresh tests");let t=await e.json();if(t.Hierarchy){let e=Object.entries(t.Hierarchy).map(e=>{let[t,n]=e;return{name:t,subcategories:n}});if(N(e),S(t.Hierarchy),t.Hierarchy[j]){let e=I[0],n=t.Hierarchy[j]||[];n.length>0&&!n.some(t=>t.name===e)&&n.length>0&&M([n[0].name])}else B(""),m(2)}}catch(e){console.error("Failed to refresh tests:",e),R("Failed to refresh tests. Please try again."),A(!0)}finally{U(!1)}}};return c?(0,o.jsxs)("div",{className:l().modalOverlay,children:[(0,o.jsx)("div",{className:3===_?l().modalContentWide:l().modalContent,children:1===_?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("h2",{children:"Select Scan Model:"}),(0,o.jsx)("div",{className:l().modelList,children:V.map(e=>(0,o.jsxs)("button",{className:"".concat(l().predefinedModelOption," ").concat(p.modelType===e.id?l().selected:""),onClick:()=>X(e.id),children:[(0,o.jsx)(r.default,{src:"/images/logos/".concat(e.id.toLowerCase(),"_logo.svg"),alt:"".concat(e.name," Logo"),className:l().logo,width:24,height:24}),e.name]},e.id))}),(0,o.jsxs)("div",{className:l().localModelSection,ref:J,children:[(0,o.jsx)("button",{className:l().localModelButton,onClick:async()=>{if(!C){let e=setTimeout(()=>{x(!0)},300);try{let e=await fetch(a.Q.model.list),t=(await e.json()).map(e=>e[0]);y(t)}catch(e){console.error("Failed to fetch local models:",e)}finally{clearTimeout(e),x(!1)}}f(e=>!e)},children:b?(0,o.jsxs)("span",{className:l().spinnerContainer,children:[(0,o.jsx)("svg",{className:l().spinningIcon,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,o.jsx)("path",{d:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"})}),"Loading Models..."]}):p.modelName||"Select Local Model"}),C&&(h.length>0?(0,o.jsx)("div",{className:l().localModelList,ref:z,children:h.map(e=>(0,o.jsx)("button",{className:"".concat(l().modelOption," ").concat(p.modelName===e?l().selected:""),onClick:()=>Z(e),children:e},e))}):(0,o.jsx)("div",{className:l().noModelsMessage,ref:z,children:"No Local Models Found"}))]}),(0,o.jsxs)("div",{className:l().scanNameSection,children:[(0,o.jsx)("label",{htmlFor:"scanName",children:"Name this Scan:"}),(0,o.jsx)("input",{id:"scanName",type:"text",placeholder:"Enter Scan Name",value:p.scanName,onChange:e=>g(t=>({...t,scanName:e.target.value})),className:l().scanNameInput})]}),(0,o.jsxs)("div",{className:l().modalActions,children:[(0,o.jsx)("button",{className:l().nextButton,onClick:$,disabled:!p.modelType||!p.scanName,children:"Next"}),(0,o.jsx)("button",{className:l().cancelButton,onClick:ed,children:"Cancel"})]})]}):2===_?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("h2",{children:"Select the following:"}),(0,o.jsx)("div",{className:l().categoryGrid,children:v.map(e=>(0,o.jsx)("button",{className:"".concat(l().categoryButton," ").concat(ei(e.name)?l().selected:""),onClick:()=>ee(e.name),children:e.name},e.name))}),(0,o.jsxs)("div",{className:l().actionButtons,children:[(0,o.jsx)("button",{className:l().testButton,onClick:()=>{k(!0)},children:"Test Model Response"}),(0,o.jsx)("button",{className:l().startButton,onClick:eo,disabled:!Object.values(p.selectedItems).some(e=>Object.values(e).some(e=>e.length>0))||W,children:Y?(0,o.jsxs)("span",{className:l().spinnerContainer,children:[(0,o.jsx)("svg",{className:l().spinningIcon,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,o.jsx)("path",{d:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"})}),"Starting Scan..."]}):"Start Scanning"})]}),(0,o.jsxs)("div",{className:l().modalActions,children:[(0,o.jsx)("button",{className:l().backButton,onClick:()=>m("local"===p.modelType?1:4),children:"Back"}),(0,o.jsx)("button",{className:l().cancelButton,onClick:ed,children:"Cancel"})]})]}):3===_?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("h2",{children:["SELECT TESTS OF ",j.toUpperCase()]}),(0,o.jsxs)("div",{className:l().splitView,children:[(0,o.jsxs)("div",{className:l().categoriesContainer,children:[(0,o.jsx)("div",{className:l().categoriesList,children:Array.isArray(T[j])&&T[j].map(e=>(0,o.jsx)("div",{className:"".concat(l().categoryItem," ").concat(I.includes(e.name)?l().active:""),onClick:t=>{er(e.name),es(e.name)},children:(0,o.jsxs)("div",{className:l().categoryItemContent,children:[(0,o.jsx)("input",{type:"checkbox",className:l().checkbox,checked:ec(e.name),onChange:t=>{t.stopPropagation(),er(e.name),es(e.name)}}),(0,o.jsx)("span",{children:e.name})]})},e.name))}),(0,o.jsxs)("div",{className:l().categoryActions,children:["Customized Tests"===j&&(0,o.jsxs)("button",{className:l().refreshButton,onClick:ep,disabled:Q,children:["Refresh Tests",Q?(0,o.jsx)("span",{className:l().refreshIcon,children:(0,o.jsx)("svg",{className:l().spinningIcon,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,o.jsx)("path",{d:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"})})}):(0,o.jsx)("span",{className:l().refreshIconStatic,children:(0,o.jsx)("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,o.jsx)("path",{d:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"})})})]}),(0,o.jsx)("button",{className:l().selectAllButton,onClick:()=>{if(3===_&&Array.isArray(T[j]))if(el()){let e=I[0];g(e=>({...e,selectedItems:{...e.selectedItems,[j]:{}}})),M([]),setTimeout(()=>M([e]),0)}else T[j].forEach(e=>{er(e.name,!0)})},children:"Select All"}),(0,o.jsx)("button",{className:l().doneButton,onClick:()=>m(2),children:"Done"})]})]}),(0,o.jsx)("div",{className:l().subcategoriesPanel,children:(0,o.jsx)("div",{className:l().subcategoriesContent,children:Array.isArray(T[j])&&(null==(n=T[j].find(e=>I.includes(e.name)))||null==(t=n.subcategories)?void 0:t.map(e=>{var t,n,s,a,c,r;return e.items&&e.items.length>0?(0,o.jsxs)("div",{className:l().subcategoryGroup,children:[(0,o.jsx)("div",{className:l().subcategoryHeader,children:(0,o.jsxs)("div",{className:l().subcategoryParent,onClick:t=>{t.target instanceof HTMLInputElement&&"checkbox"===t.target.type||ea(e.name)},children:[(0,o.jsx)("input",{type:"checkbox",className:l().checkbox,checked:null==(n=p.selectedItems[j])||null==(t=n[I[0]])?void 0:t.includes(e.name),onChange:t=>{t.stopPropagation(),et(e.name,e.items)}}),(0,o.jsx)("span",{children:e.name}),(0,o.jsx)("button",{className:l().expandButton,onClick:t=>{ea(e.name)},children:I.includes(e.name)?"▼":"▶"})]})}),I.includes(e.name)&&e.items&&(0,o.jsx)("div",{className:l().subcategoriesGrid,children:e.items.map(e=>{var t,n,s,a;return(0,o.jsxs)("div",{className:"".concat(l().subcategoryTile," ").concat((null==(n=p.selectedItems[j])||null==(t=n[I[0]])?void 0:t.includes(e))?l().selected:""),onClick:t=>{t.target instanceof HTMLInputElement&&"checkbox"===t.target.type||et(e)},children:[(0,o.jsx)("input",{type:"checkbox",className:l().checkbox,checked:null==(a=p.selectedItems[j])||null==(s=a[I[0]])?void 0:s.includes(e),onChange:t=>{et(e)}}),(0,o.jsx)("span",{children:e})]},e)})})]},e.name):(0,o.jsxs)("div",{className:"".concat(l().subcategoryTile," ").concat((null==(a=p.selectedItems[j])||null==(s=a[I[0]])?void 0:s.includes(e.name))?l().selected:""),onClick:t=>{t.target instanceof HTMLInputElement&&"checkbox"===t.target.type||et(e.name,e.items)},children:[(0,o.jsx)("input",{type:"checkbox",className:l().checkbox,checked:null==(r=p.selectedItems[j])||null==(c=r[I[0]])?void 0:c.includes(e.name),onChange:t=>{t.stopPropagation(),et(e.name,e.items)}}),(0,o.jsx)("span",{children:e.name})]},e.name)}))})})]})]}):4===_?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("h2",{children:"Configure Cloud Model"}),(0,o.jsxs)("div",{className:l().cloudConfigForm,children:[(0,o.jsxs)("div",{className:l().formGroup,children:[(0,o.jsxs)("label",{htmlFor:"cloudModelName",children:["Model Name: ",(0,o.jsx)("span",{className:l().requiredField,children:"*"})]}),(0,o.jsx)("input",{id:"cloudModelName",type:"text",placeholder:"Enter Model Name",value:D,onChange:e=>E(e.target.value),className:l().formInput,required:!0})]}),(0,o.jsxs)("div",{className:l().formGroup,children:[(0,o.jsxs)("label",{htmlFor:"apiKey",children:[(()=>{let e=V.find(e=>e.id===p.modelType);return e?e.name:""})()," API Key:"," ",(0,o.jsx)("span",{className:l().requiredField,children:"*"})]}),(0,o.jsx)("input",{id:"apiKey",type:"text",placeholder:"Enter API Key",value:F,onChange:e=>H(e.target.value),className:l().formInput,required:!0})]}),(0,o.jsxs)("div",{className:l().formGroup,children:[(0,o.jsx)("label",{htmlFor:"additionalArgs",children:"Additional Arguments:"}),(0,o.jsx)("textarea",{id:"additionalArgs",placeholder:"Enter key:value pairs (one per line)",value:P,onChange:e=>G(e.target.value),className:l().formTextarea,rows:4}),(0,o.jsx)("small",{className:l().helpText,children:"Example: top_p: 0.7"})]})]}),(0,o.jsx)("div",{className:l().cloudConfigActions,children:(0,o.jsx)("button",{className:l().selectDatasetButton,onClick:em,disabled:!D||!F,children:"Select Tests"})}),(0,o.jsxs)("div",{className:l().modalActions,children:[(0,o.jsx)("button",{className:l().backButton,onClick:()=>m(1),children:"Back"}),(0,o.jsx)("button",{className:l().cancelButton,onClick:ed,children:"Cancel"})]})]}):null}),2===_&&(0,o.jsx)(d,{isOpen:w,onClose:()=>k(!1),modelName:"local"===p.modelType?p.modelName||"":"".concat(p.modelType,".py"),cloudModelName:"local"!==p.modelType?D:void 0,apiKey:"local"!==p.modelType?F:void 0,additionalArgs:"local"!==p.modelType?P:void 0}),L&&(0,o.jsx)(u,{isOpen:L,onClose:()=>A(!1),onComplete:ed,message:O})]}):null}},87714:e=>{e.exports={overlay:"ResponseDialog_overlay__KBSvP",dialog:"ResponseDialog_dialog__qLzK8",message:"ResponseDialog_message___r0su",closeButton:"ResponseDialog_closeButton__ZQXtv"}},90830:e=>{e.exports={overlay:"TestResponseDialog_overlay__AQCaE",dialog:"TestResponseDialog_dialog__GDYAo",promptInput:"TestResponseDialog_promptInput__K2Ee5",response:"TestResponseDialog_response__gdIRZ",error:"TestResponseDialog_error__0bC4w",buttons:"TestResponseDialog_buttons__zub0L",testButton:"TestResponseDialog_testButton__Z1bts",backButton:"TestResponseDialog_backButton__NsYr9"}}}]);