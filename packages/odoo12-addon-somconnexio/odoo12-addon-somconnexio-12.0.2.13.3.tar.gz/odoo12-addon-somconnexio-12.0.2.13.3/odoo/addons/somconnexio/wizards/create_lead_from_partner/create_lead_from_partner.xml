<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
  <data>
    <record id="view_form_partner_create_lead_wizard" model="ir.ui.view">
       <field name="name">Partner Lead Create Wizard</field>
       <field name="model">partner.create.lead.wizard</field>
       <field name="arch" type="xml">
           <form>
              <field name="available_email_ids" invisible="1" />
              <field name="available_product_categories" invisible="1" />
              <field name="available_products" invisible="1" />
              <field name="without_fix" invisible="1" />
              <h1>
                     <field name="title"/>
              </h1>
              <group col="2">
                     <group col="1">
                            <group name="basic info">
                                   <field name="opportunity"/>
                                   <field name="team_id" required="1"/>
                                   <field name="partner_id"/>
                                   <field name="bank_id"
                                          options="{'no_create_edit':True}"
                                          domain="[('partner_id', '=', partner_id)]"/>
                                   <field name="email_id" widget="many2one_tags_crm_lead_email"
                                          options="{'no_create_edit':True}"
                                          context="{'email_tags': True}"
                                          domain="[('id', 'in', available_email_ids)]"
                                   />
                                   <field name="phone_contact"
                                          options="{'no_create_edit': [('phone_contact', '!=', False)]}"/>
                                   <field name="product_categ_id"
                                          options="{'no_create_edit':True}"
                                          domain="[('id', 'in', available_product_categories)]"/>
                                   <field name="type"/>
                                   <separator/>
                            </group>
                            <group name="service type info" attrs="{'invisible': [('product_categ_id','=', False)]}">
                                   <field name="has_mobile_pack_offer_text" widget="Radio"
                                          attrs="{'invisible': [('product_categ_id','!=', %(somconnexio.mobile_service)d)]}"/>
                                   <field name="product_id"
                                          options="{'no_create_edit':True}"
                                          domain="[('id', 'in', available_products)]"/>
                                   <separator/>
                                   <field name="icc" attrs="{
                                          'invisible': [
                                                 ('product_categ_id','!=', %(somconnexio.mobile_service)d),
                                          ]
                                   }"/>
                            </group>
                     </group>
                     <group name="portability info" col="1"
                            attrs="{'invisible': [('type','!=','portability')]}">

                            <group name="mobile portability info"
                                   attrs="{'invisible': [('product_categ_id','!=', %(somconnexio.mobile_service)d)]}">

                                   <field name="previous_contract_type"
                                          attrs="{'required': [('product_categ_id','=', %(somconnexio.mobile_service)d),
                                                               ('type','=','portability')],
                                                 }"/>
                                   <field name="phone_number"
                                          attrs="{'required': [('product_categ_id','=', %(somconnexio.mobile_service)d),
                                                               ('type','=','portability')],
                                                 }"/>
                                   <field name="donor_icc"
                                          attrs="{'required': [('product_categ_id','=', %(somconnexio.mobile_service)d),
                                                               ('previous_contract_type','=','prepaid')],
                                                 }"/>
                                   <field name="previous_mobile_provider"
                                          domain="[('mobile', '=', True)]"
                                          options="{'no_create_edit':True}"
                                          attrs="{'required': [('product_categ_id','=', %(somconnexio.mobile_service)d),
                                                               ('type','=','portability')],
                                                 }"/>
                            </group>
                            <group name="fiber portability info"
                                   attrs="{'invisible': [
                                                 ('product_categ_id','not in', [
                                                        %(somconnexio.broadband_fiber_service)d, %(somconnexio.broadband_4G_service)d
                                                 ]),
                                          ]}">
                                   <field name="keep_landline"
                                          attrs="{'invisible': [('without_fix', '=', True)]}"/>
                                   <field name="landline"
                                          attrs="{'required': [('product_categ_id','=', %(somconnexio.broadband_fiber_service)d),
                                                               ('type','=','portability')],
                                                 }"/>
                                   <field name="previous_BA_provider"
                                          domain="[('broadband', '=', True)]"
                                          options="{'no_create_edit':True}"
                                          attrs="{'required': [
                                                        ('product_categ_id','in', [
                                                               %(somconnexio.broadband_fiber_service)d, %(somconnexio.broadband_4G_service)d
                                                        ]),
                                                        ('type','=','portability')
                                                 ]}"/>
                                   <field name="previous_BA_service"
                                          attrs="{'required': [
                                                        ('product_categ_id','in', [
                                                               %(somconnexio.broadband_fiber_service)d, %(somconnexio.broadband_4G_service)d
                                                        ]),
                                                        ('type','=','portability')
                                                 ]}"/>
                            </group>
                            <group name="previous owner info">
                                   <field name="previous_owner_vat_number"/>
                                   <field name="previous_owner_first_name"/>
                                   <field name="previous_owner_name"/>
                            </group>
                     </group>
              </group>
              <group col="2" attrs="{'invisible': [('product_categ_id', '=', False)]}">
                     <group name="Delivery address" string="Delivery address">
                            <field name="delivery_country_id"
                                   options="{'no_create_edit':True}"
                                   attrs="{'required': ['|', ('icc','=', False), ('icc','=','')]}"/>
                            <field name="delivery_state_id"
                                   domain="[('country_id', '=', delivery_country_id)]"
                                   options="{'no_create_edit':True}"
                                   attrs="{'required': ['|', ('icc','=',False), ('icc','=','')]}"/>
                            <field name="delivery_street"
                                   attrs="{'required': ['|', ('icc','=',False), ('icc','=','')]}"/>
                            <field name="delivery_zip_code"
                                   attrs="{'required': ['|', ('icc','=',False), ('icc','=','')]}"/>
                            <field name="delivery_city"
                                   attrs="{'required': ['|', ('icc','=',False), ('icc','=','')]}"/>
                     </group>
                     <group name="Invoice address" string="Invoice address">
                            <field name="invoice_country_id"
                                   options="{'no_create_edit':True}"/>
                            <field name="invoice_state_id"
                                   domain="[('country_id', '=', invoice_country_id)]"
                                   options="{'no_create_edit':True}"/>
                            <field name="invoice_street" />
                            <field name="invoice_zip_code" />
                            <field name="invoice_city" />
                     </group>
              </group>
              <group col="2" attrs="{'invisible': [('product_categ_id', '=', False)]}">
                     <group name="Service address" string="Service address"
                            attrs="{'invisible': [('product_categ_id', '=', %(somconnexio.mobile_service)d)]}">
                            <field name="service_country_id"
                                   options="{'no_create_edit':True}"
                                   attrs="{'required': [('product_categ_id', '!=', %(somconnexio.mobile_service)d)]}"/>
                            <field name="service_state_id"
                                   domain="[('country_id', '=', service_country_id)]"
                                   options="{'no_create_edit':True}"
                                   attrs="{'required': [('product_categ_id', '!=', %(somconnexio.mobile_service)d)]}"/>
                            <field name="service_street"
                                   attrs="{'required': [('product_categ_id', '!=', %(somconnexio.mobile_service)d)]}"/>
                            <field name="service_zip_code"
                                   attrs="{'required': [('product_categ_id', '!=', %(somconnexio.mobile_service)d)]}"/>
                            <field name="service_city"
                                   attrs="{'required': [('product_categ_id', '!=', %(somconnexio.mobile_service)d)]}"/>
                     </group>
              </group>
              <footer>
                     <button type="object" name="create_lead" string="Create" />
                     <button special="cancel" string="Cancel" class="btn-secondary"/>
              </footer>
           </form>
       </field>
    </record>
    <act_window id="action_partner_lead_create_wizard"
                name="Create Lead"
                res_model="partner.create.lead.wizard"
                view_type="form"
                view_mode="form"
                target="new"
                />
    <record id="view_partner_form_lead_creation_wizard_button" model="ir.ui.view">
      <field name="name">partner.form.lead.creation.wizard.button</field>
      <field name="model">res.partner</field>
      <field name="inherit_id" ref="easy_my_coop.view_partner_form_easy_my_coop"/>
      <field name="arch" type="xml">
        <button id="action_view_update_partner_info" position="after">
            <button name="%(action_partner_lead_create_wizard)d"
                string="Create Lead"
                type="action"
                context="{'default_active_id': active_id}"
                />
        </button>
      </field>
    </record>
  </data>
</odoo>
