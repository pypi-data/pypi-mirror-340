Metadata-Version: 2.4
Name: xingshu
Version: 1.0.2
Summary: ä¸“ä¸ºä¸­æ–‡æ¯è¯­å¼€å‘è€…æ‰“é€ çš„é‡åŒ–äº¤æ˜“ç ”å‘æ¡†æ¶ã€‚
Author-email: bhzy <2024305928@qq.com>
License-Expression: MIT
Project-URL: Homepage, https://github.com/bhzyxyqy/xingshu
Project-URL: Issues, https://github.com/bhzyxyqy/xingshu/issues
Classifier: Programming Language :: Python :: 3
Classifier: Operating System :: OS Independent
Requires-Python: >=3.8
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: numpy>=2.2.3
Requires-Dist: ta-lib>=0.6.0
Requires-Dist: tzlocal>=5.3
Requires-Dist: xingshu_ctp>=0.0.1
Requires-Dist: xingshu-sqlite>=0.0.1
Requires-Dist: xingshu-cta-jymokuai>=1.0.1
Dynamic: license-file

# æ˜Ÿæ¢é‡åŒ–æ¡†æ¶

åˆè¡·ï¼šåˆšå¼€å§‹æ˜¯æƒ³å•çº¯æƒ³å†™ä¸€ä¸ªç­–ç•¥ï¼Œå¯¹æ¯”å¤šä¸ªæ¡†æ¶åé€‰æ‹©äº†[vnpy]([github.com](https://github.com/vnpy/vnpy))ï¼Œä»–çš„æ–‡æ¡£å¾ˆè¯¦ç»†ï¼Œä½†æˆ‘å…¥é—¨è¿˜æ˜¯ç”¨äº†è¾ƒé•¿çš„æ—¶é—´å»é˜…è¯»æ–‡æ¡£å’Œçœ‹ä»–çš„æºç ï¼Œåæ¥è€ƒè™‘åˆ°æˆ‘ä¸éœ€è¦ä½¿ç”¨å›¾å½¢åŒ–ç•Œé¢å’Œæƒ³ä»¥æ¯è¯­ä¸­æ–‡å¯¹æˆ‘åç»­ç­–ç•¥å¼€å‘å’Œç­–ç•¥ç»´æŠ¤æ›´å‹å¥½çš„æƒ³æ³•ï¼Œå†³å®šä»¥vnpyä¸­çš„`examples/no_ui/run.py`ä¸ºåŸºç¡€ï¼Œè¿›è¡Œå…¨é¢ä¸­æ–‡é‡æ„ã€‚

æ˜Ÿæ¢ï¼ˆxingshuï¼‰â€”â€” ä¸“ä¸ºä¸­æ–‡æ¯è¯­å¼€å‘è€…æ‰“é€ çš„é‡åŒ–äº¤æ˜“ç ”å‘æ¡†æ¶ï¼Œè‡´åŠ›äºæä¾›æ›´å‹å¥½çš„å¼€å‘ä½“éªŒã€‚ä½œä¸ºæœ¬åœŸåŒ–ç­–ç•¥ç ”å‘è§£å†³æ–¹æ¡ˆï¼Œå®ƒä¸ä»…æ·±åº¦å¥‘åˆä¸­æ–‡å¼€å‘è€…çš„æ€ç»´ä¹ æƒ¯ï¼Œæ›´æä¾›ä»ç­–ç•¥è®¾è®¡åˆ°é«˜æ•ˆè½åœ°çš„å…¨æµç¨‹æ”¯æŒï¼ŒåŠ©åŠ›å¼€å‘è€…èšç„¦æ ¸å¿ƒäº¤æ˜“é€»è¾‘çš„æ„å»ºä¸ä¼˜åŒ–ã€‚

## ğŸ“– é¡¹ç›®èƒŒæ™¯

ä¸ºæ»¡è¶³ä¸­æ–‡å¼€å‘è€…å¯¹ç­–ç•¥ä»£ç å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§çš„éœ€æ±‚ï¼Œæœ¬é¡¹ç›®ä»¥[vnpy-3.9.4]([vnpy/vnpy at 3.9.4](https://github.com/vnpy/vnpy/tree/3.9.4))ä¸ºåŸºç¡€ï¼Œå…¨é¢é‡æ„ï¼š

- **å…¨ä¸­æ–‡å‘½åä½“ç³»**ï¼šåŒ…/æ¨¡å—/ç±»/å˜é‡100%ä¸­æ–‡æ ‡è¯†
- **æ·±åº¦è¯­ä¹‰å¯¹åº”**ï¼šä¿ç•™åŸæ¡†æ¶è®¾è®¡ç†å¿µï¼Œå»ºç«‹ç²¾ç¡®ä¸­è‹±æœ¯è¯­æ˜ å°„
- **æ— ç¼å…¼å®¹å‡çº§**ï¼šåœ¨ä¿æŒåŠŸèƒ½ä¸€è‡´æ€§çš„åŸºç¡€ä¸Šæå‡ä¸­æ–‡å¼€å‘ä½“éªŒ

## ğŸš€ æ ¸å¿ƒä¼˜åŠ¿

### ä¸­æ–‡å‹å¥½æ€§

- å®Œå…¨æ¶ˆé™¤è‹±æ–‡æœ¯è¯­éšœç¢
- APIè®¾è®¡ç¬¦åˆä¸­æ–‡ç¼–ç¨‹æ€ç»´ä¹ æƒ¯
- æ–‡æ¡£å­—ç¬¦ä¸²åŠæ³¨é‡Šå…¨ä¸­æ–‡åŒ–

### æ¶æ„å»¶ç»­æ€§

- å®Œæ•´ä¿ç•™vnpyçš„ä¼˜ç§€æ¶æ„è®¾è®¡
- äº‹ä»¶é©±åŠ¨å¼•æ“ã€ä¸»å¼•æ“ç­‰æ ¸å¿ƒæœºåˆ¶ä¿æŒä¸å˜
- æ¸è¿›å¼é‡æ„ä¿è¯åŠŸèƒ½ç¨³å®šæ€§

### å¼€å‘ä¾¿æ·æ€§

- æ›´ç›´è§‚çš„ä»£ç å¯¼èˆª
- é™ä½æ–°äººå­¦ä¹ æˆæœ¬
- æå‡é•¿æœŸç»´æŠ¤æ•ˆç‡

### å¼€å‘è¿›åº¦çœ‹æ¿

| æ¨¡å—            | è¿›åº¦   | é¢„è®¡å®Œæˆæ—¶é—´ |
| :-------------- | :----- | :----------- |
| äº‹ä»¶å¼•æ“        | âœ… 100% | å·²å‘å¸ƒ       |
| ä¸»å¼•æ“          | âœ… 100% | å·²å‘å¸ƒ       |
| CTAè‡ªåŠ¨äº¤æ˜“æ¨¡å— | âœ… 100% | å·²å‘å¸ƒ       |
| CTPæ¥å£         | âœ… 100% | å·²å‘å¸ƒ       |



### å®‰è£…

```
pip install xingshu
```

### ä½¿ç”¨

åœ¨ä»»æ„ç›®å½•ä¸‹åˆ›å»ºrun.pyï¼Œå†™å…¥ç¤ºä¾‹ä»£ç ï¼š

```
# è¿è¡Œå•ä¸ªç­–ç•¥
# è¿è¡Œæ‰€æœ‰ç­–ç•¥çš„ç¤ºä¾‹ä»£ç åœ¨æœ¬é¡¹ç›®githubä¸‹ï¼šè¿è¡Œç¤ºä¾‹ æ–‡ä»¶å¤¹

import multiprocessing
import sys
from time import sleep
from datetime import datetime, time
from logging import INFO

from xingshu.åŒ…_äº‹ä»¶å¼•æ“ import ç±»_äº‹ä»¶å¼•æ“
from xingshu.åŒ…_äº¤æ˜“æ ¸å¿ƒ.æ¨¡å—_è®¾ç½® import å…¨å±€è®¾ç½®
from xingshu.åŒ…_äº¤æ˜“æ ¸å¿ƒ.æ¨¡å—_ä¸»å¼•æ“ import ç±»_ä¸»å¼•æ“
from xingshu_ctp import ç±»_CTPç½‘å…³

from xingshu-cta-jymokuai import ç±»_CTAç­–ç•¥åº”ç”¨
from xingshu-cta-jymokuai.æ¨¡å—_åŸºç¡€ import äº‹ä»¶ç±»å‹_CTAæ—¥å¿—


å…¨å±€è®¾ç½®["æ—¥å¿—.å¯ç”¨"] = True
å…¨å±€è®¾ç½®["æ—¥å¿—.çº§åˆ«"] = INFO
å…¨å±€è®¾ç½®["æ—¥å¿—.æ§åˆ¶å°"] = True

ctp_è®¾ç½® = {
    "ç”¨æˆ·å": "",
    "å¯†ç ": "",
    "ç»çºªå•†ä»£ç ": "",
    "äº¤æ˜“æœåŠ¡å™¨": "",
    "è¡Œæƒ…æœåŠ¡å™¨": "",
    "äº§å“åç§°": "",
    "æˆæƒç¼–ç ": "",
    "äº§å“ä¿¡æ¯": ""
}

# ç­–ç•¥é…ç½®åˆ—è¡¨ï¼ˆå¯æ‰©å±•æ·»åŠ å¤šä¸ªç­–ç•¥ï¼‰
ç­–ç•¥é…ç½®åˆ—è¡¨ = [
    {
        "ç­–ç•¥ç±»å": "ç¤ºä¾‹ç­–ç•¥_åŸºç¡€æ•™ç¨‹",
        "ç­–ç•¥åç§°": "ç¤ºä¾‹ç­–ç•¥",
        "åˆçº¦æ ‡è¯†": "c2505.å¤§å•†æ‰€",
        "å‚æ•°è®¾ç½®": {
            "åˆå§‹æ‰‹æ•°": 1
        }
    }
]

# ä¸­å›½æœŸè´§å¸‚åœºäº¤æ˜“æ—¶æ®µï¼ˆæ—¥ç›˜/å¤œç›˜ï¼‰
æ—¥ç›˜å¼€å§‹æ—¶é—´ = time(8, 45)
æ—¥ç›˜ç»“æŸæ—¶é—´ = time(15, 0)

å¤œç›˜å¼€å§‹æ—¶é—´ = time(20, 45)
å¤œç›˜ç»“æŸæ—¶é—´ = time(2, 45)


def æ£€æŸ¥äº¤æ˜“æ—¶æ®µ():
    """æ£€æŸ¥æ˜¯å¦åœ¨äº¤æ˜“æ—¶æ®µå†…"""
    å½“å‰æ—¶é—´ = datetime.now().time()

    æ˜¯å¦äº¤æ˜“æ—¶æ®µ = False
    if (
            (å½“å‰æ—¶é—´ >= æ—¥ç›˜å¼€å§‹æ—¶é—´ and å½“å‰æ—¶é—´ <= æ—¥ç›˜ç»“æŸæ—¶é—´)
            or (å½“å‰æ—¶é—´ >= å¤œç›˜å¼€å§‹æ—¶é—´)
            or (å½“å‰æ—¶é—´ <= å¤œç›˜ç»“æŸæ—¶é—´)
    ):
        æ˜¯å¦äº¤æ˜“æ—¶æ®µ = True

    return æ˜¯å¦äº¤æ˜“æ—¶æ®µ


def è¿è¡Œå­è¿›ç¨‹():
    """åœ¨å­è¿›ç¨‹ä¸­è¿è¡Œçš„ä¸šåŠ¡é€»è¾‘"""
    å…¨å±€è®¾ç½®["æ—¥å¿—.æ–‡ä»¶"] = True

    # åˆ›å»ºäº‹ä»¶å¼•æ“
    äº‹ä»¶å¼•æ“ = ç±»_äº‹ä»¶å¼•æ“()

    # åˆ›å»ºä¸»å¼•æ“
    ä¸»å¼•æ“ = ç±»_ä¸»å¼•æ“(äº‹ä»¶å¼•æ“)
    ä¸»å¼•æ“.æ·»åŠ ç½‘å…³(ç±»_CTPç½‘å…³)

    # æ·»åŠ CTAåº”ç”¨
    CTAå¼•æ“ = ä¸»å¼•æ“.æ·»åŠ åº”ç”¨(ç±»_CTAç­–ç•¥åº”ç”¨)
    ä¸»å¼•æ“.è®°å½•æ—¥å¿—("ä¸»å¼•æ“åˆ›å»ºæˆåŠŸ")

    # æ³¨å†Œæ—¥å¿—äº‹ä»¶ç›‘å¬
    æ—¥å¿—å¼•æ“ = ä¸»å¼•æ“.è·å–å¼•æ“("æ—¥å¿—")
    äº‹ä»¶å¼•æ“.æ³¨å†Œç±»å‹å¤„ç†å™¨(äº‹ä»¶ç±»å‹_CTAæ—¥å¿—, æ—¥å¿—å¼•æ“.å¤„ç†æ—¥å¿—äº‹ä»¶)
    ä¸»å¼•æ“.è®°å½•æ—¥å¿—("æ³¨å†Œæ—¥å¿—äº‹ä»¶ç›‘å¬")

    # è¿æ¥CTPæ¥å£
    ä¸»å¼•æ“.è¿æ¥ç½‘å…³(ctp_è®¾ç½®, "CTP")
    ä¸»å¼•æ“.è®°å½•æ—¥å¿—("è¿æ¥CTPæ¥å£")

    # ç­‰å¾…10ç§’ç¡®ä¿è¿æ¥æˆåŠŸ
    sleep(10)

    # åˆå§‹åŒ–CTAå¼•æ“
    CTAå¼•æ“.åˆå§‹åŒ–å¼•æ“()
    ä¸»å¼•æ“.è®°å½•æ—¥å¿—("CTAç­–ç•¥å¼•æ“åˆå§‹åŒ–å®Œæˆ")

    # å¾ªç¯å¤„ç†æ‰€æœ‰ç­–ç•¥é…ç½®
    for ç­–ç•¥é…ç½® in ç­–ç•¥é…ç½®åˆ—è¡¨:
        ç­–ç•¥åç§° = ç­–ç•¥é…ç½®["ç­–ç•¥åç§°"]

        if ç­–ç•¥åç§° not in CTAå¼•æ“.è¿è¡Œç­–ç•¥å­—å…¸:
            ä¸»å¼•æ“.è®°å½•æ—¥å¿—(f"åˆ›å»ºç­–ç•¥ï¼š{ç­–ç•¥åç§°}")
            CTAå¼•æ“.æ·»åŠ ç­–ç•¥(
                ç±»å=ç­–ç•¥é…ç½®["ç­–ç•¥ç±»å"],
                ç­–ç•¥åç§°=ç­–ç•¥åç§°,
                åˆçº¦æ ‡è¯†=ç­–ç•¥é…ç½®["åˆçº¦æ ‡è¯†"],
                é…ç½®å­—å…¸=ç­–ç•¥é…ç½®["å‚æ•°è®¾ç½®"]
            )
            # åˆå§‹åŒ–ç­–ç•¥
            CTAå¼•æ“.åˆå§‹åŒ–ç­–ç•¥(ç­–ç•¥åç§°)
            sleep(5)
            CTAå¼•æ“.å¯åŠ¨ç­–ç•¥(ç­–ç•¥åç§°)
        else:
            ä¸»å¼•æ“.è®°å½•æ—¥å¿—(f"æ›´æ–°ç­–ç•¥å‚æ•°ï¼š{ç­–ç•¥åç§°}")
            CTAå¼•æ“.æ›´æ–°ç­–ç•¥é…ç½®(ç­–ç•¥åç§°=ç­–ç•¥åç§°,é…ç½®å­—å…¸=ç­–ç•¥é…ç½®["å‚æ•°è®¾ç½®"])
            # åˆå§‹åŒ–ç­–ç•¥
            CTAå¼•æ“.åˆå§‹åŒ–ç­–ç•¥(ç­–ç•¥åç§°)
            sleep(5)
            CTAå¼•æ“.å¯åŠ¨ç­–ç•¥(ç­–ç•¥åç§°)

    # æŒç»­è¿è¡Œæ£€æŸ¥
    while True:
        sleep(10)

        # æ£€æŸ¥äº¤æ˜“æ—¶æ®µ
        æ˜¯å¦äº¤æ˜“æ—¶æ®µ = æ£€æŸ¥äº¤æ˜“æ—¶æ®µ()
        if not æ˜¯å¦äº¤æ˜“æ—¶æ®µ:
            print("å…³é—­å­è¿›ç¨‹")
            ä¸»å¼•æ“.å…³é—­()
            sys.exit(0)


def è¿è¡Œçˆ¶è¿›ç¨‹():
    """åœ¨çˆ¶è¿›ç¨‹ä¸­è¿è¡Œçš„å®ˆæŠ¤é€»è¾‘"""
    print("å¯åŠ¨CTAç­–ç•¥å®ˆæŠ¤çˆ¶è¿›ç¨‹")

    å­è¿›ç¨‹ = None

    while True:
        # æŒç»­æ£€æŸ¥äº¤æ˜“æ—¶æ®µ
        æ˜¯å¦äº¤æ˜“æ—¶æ®µ = æ£€æŸ¥äº¤æ˜“æ—¶æ®µ()

        # äº¤æ˜“æ—¶æ®µå¯åŠ¨å­è¿›ç¨‹
        if æ˜¯å¦äº¤æ˜“æ—¶æ®µ and å­è¿›ç¨‹ is None:
            print("å¯åŠ¨å­è¿›ç¨‹")
            å­è¿›ç¨‹ = multiprocessing.Process(target=è¿è¡Œå­è¿›ç¨‹)
            å­è¿›ç¨‹.start()
            print("å­è¿›ç¨‹å¯åŠ¨æˆåŠŸ")

        # éäº¤æ˜“æ—¶æ®µå…³é—­å­è¿›ç¨‹
        if not æ˜¯å¦äº¤æ˜“æ—¶æ®µ and å­è¿›ç¨‹ is not None:
            if not å­è¿›ç¨‹.is_alive():
                å­è¿›ç¨‹ = None
                print("å­è¿›ç¨‹å…³é—­æˆåŠŸ")

        sleep(5)


if __name__ == "__main__":
    è¿è¡Œçˆ¶è¿›ç¨‹()
```

### ç­–ç•¥ç¤ºä¾‹

```
ç­–ç•¥ç¤ºä¾‹ä»£ç é€šå¸¸ä¿å­˜åœ¨ï¼š xingshu_ctastrategy\ç­–ç•¥æ–‡ä»¶å¤¹ ä¸­ã€‚

å¦‚æœæ‚¨è‡ªå·±ç¼–å†™äº†ç­–ç•¥æ–‡ä»¶ï¼Œå¯ä»¥é€‰æ‹©å°†å®ƒä»¬æ”¾ç½®åœ¨è¯¥ç›®å½•ä¸‹ï¼Œä¹Ÿå¯ä»¥åœ¨ç”¨æˆ·ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹æ¥å­˜æ”¾ã€‚å¯¹äº Windows ç”¨æˆ·æ¥è¯´ï¼Œè‡ªå®šä¹‰çš„ç­–ç•¥æ–‡ä»¶å¤¹è·¯å¾„é€šå¸¸ä¸ºï¼š

C:\Users\xxx\ç­–ç•¥æ–‡ä»¶å¤¹ï¼ˆå…¶ä¸­ xxx ä¸ºæ‚¨çš„ç”¨æˆ·åï¼‰ã€‚
```



## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ä¸­æ–‡å‘½åçš„ï¼š

- ğŸ“ æ–‡æ¡£ç¿»è¯‘
- ğŸ› Bugä¿®å¤
- ğŸ¯ åŠŸèƒ½å¢å¼º
