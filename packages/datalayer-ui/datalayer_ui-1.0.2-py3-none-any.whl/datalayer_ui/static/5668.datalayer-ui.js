"use strict";(self.webpackChunk_datalayer_ui=self.webpackChunk_datalayer_ui||[]).push([[5668],{46916:(e,s,n)=>{n.d(s,{E:()=>l});var t=n(71791),i=n(99180),a=n(38621),o=n(9387),r=n(18683);function l(e){const{commandRegistry:s,kernelDesc:n,save:l,sessionConnection:c}=e,[d,u]=(0,o.useState)();return(0,o.useEffect)((()=>{const e=()=>{u(c?.kernel?.status)};return e(),c?.statusChanged.connect(e),c?.connectionStatusChanged.connect(e),()=>{c?.statusChanged.disconnect(e),c?.connectionStatusChanged.disconnect(e)}}),[c]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.Q,{variant:"invisible",size:"small",leadingVisual:a.iKr,disabled:void 0===n?.location,onClick:l,children:"Save"}),(0,r.jsx)(i.Q,{variant:"invisible",size:"small",leadingVisual:a.udU,disabled:!n?.location||"busy"===d,onClick:e=>{s?.execute(t.nx.runAll)},children:"Run all"}),(0,r.jsx)(i.Q,{variant:"invisible",size:"small",leadingVisual:a.wFz,disabled:!n?.location||"busy"!==d,onClick:e=>{s?.execute(t.nx.interrupt)},children:"Interrupt"})]})}},95668:(e,s,n)=>{n.r(s),n.d(s,{LessonEdit:()=>B,default:()=>w});var t=n(9387),i=n(20568),a=n(79026),o=n(97096),r=n(98754),l=n(8586),c=n(99180),d=n(15824),u=n(88996),h=n(48371),m=n(64664),p=n(38621),x=n(2159),y=n(16476),v=n(86218),g=n(46916),f=n(17810),j=n(23530),k=n(53850),b=n(97734),A=n(50906),C=n(54520),S=n(18683);const B=()=>{const e=(0,t.useMemo)((()=>[new x._]),[]),{lessonId:s}=(0,i.g)();if(!s)return(0,S.jsx)(S.Fragment,{});const n=(0,f.J)(),B=(0,a.S)(),w=(0,j.Z)(),E=(0,A.mt)(),L=(0,y.Gx)(),N=E.layout().space,R=(0,C.OK)().saveRequest,z=L.selectNotebookModel(s),{cloneLesson:I,getLesson:T,refreshLesson:V,updateNotebook:F,updateNotebookModel:Q}=(0,k.E)(),[_,D]=(0,t.useState)("editor"),{enqueueToast:M}=(0,b.d)(),[P,J]=(0,t.useState)(),[O,q]=(0,t.useState)({name:"",description:""}),[K,U]=(0,t.useState)({name:void 0,description:void 0}),$=(e,s)=>{s.preventDefault(),E.layout().resetRightPortal(),D(e)};(0,t.useEffect)((()=>(E.layout().showBackdrop(),V(s).then((e=>{if(E.layout().hideBackdrop(),e.success){const e=T(s);e?(J(e),E.layout().setItem(e),q({name:e.name,description:e.description})):w("/")}})).finally((()=>{E.layout().hideBackdrop()})),()=>{J(void 0),L.reset(),E.layout().setItem(void 0)})),[s]);const G=()=>{z?.model?.cells&&(E.layout().showBackdrop("Saving the lesson..."),Q(s,z.model.toJSON()).then((e=>{e.success&&(M("The lesson is successfully updated.",{variant:"success"}),E.layout().triggerItemsRefresh(),J({...P,nbformat:z.model.toJSON()}))})).finally((()=>{E.layout().hideBackdrop()})))};(0,t.useEffect)((()=>{R&&P&&G()}),[R]),(0,t.useEffect)((()=>{U({...K,name:void 0===O.name?void 0:O.name.length>2,description:void 0===O.description?void 0:O.description.length>2})}),[O]);const H=(0,t.useCallback)((async e=>{B({title:"Are you sure?",content:"Please confirm you want to clone this lesson in your private library."}).then((e=>{e&&(E.layout().showBackdrop(),I(s).then((e=>{E.layout().hideBackdrop(),e.success&&(M(e.message,{variant:"success"}),E.layout().triggerItemsRefresh(),w(`/${n?.handle}/library/lessons`))})).finally((()=>{E.layout().hideBackdrop()})))}))}),[B,P]);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(o.z,{children:(0,S.jsxs)(r.A,{display:"flex",children:[(0,S.jsx)(r.A,{flex:1,children:(0,S.jsx)(l.A,{sx:{fontSize:3},children:"Lesson editor"})}),"editor"===_&&(0,S.jsx)(r.A,{children:(0,S.jsx)(g.E,{commandRegistry:L.selectNotebookAdapter(s)?.commands,save:G})}),P&&N&&(0,S.jsx)(r.A,{children:(0,S.jsx)(c.Q,{variant:"invisible",size:"small",leadingVisual:p.Nc$,onClick:H,children:"Clone"})})]})}),P&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(d.A,{sx:{mt:3,mb:3},children:[(0,S.jsx)(d.A.Link,{href:"",selected:"editor"===_,onClick:e=>$("editor",e),children:"Editor"}),(0,S.jsx)(d.A.Link,{href:"",selected:"properties"===_,onClick:e=>$("properties",e),children:"Properties"})]}),"editor"===_&&(0,S.jsx)(r.A,{children:P.nbformat&&(0,S.jsx)(v.g,{id:s,height:"calc(100vh - 240px)",maxHeight:"calc(100vh - 240px)",cellMetadataPanel:!0,nbformat:P.nbformat,extensions:e})}),"properties"===_&&(0,S.jsx)(r.A,{display:"grid",gridTemplateColumns:"1fr 1fr",children:(0,S.jsx)(r.A,{children:(0,S.jsxs)(r.A,{sx:{label:{marginTop:2}},children:[(0,S.jsxs)(u.A,{children:[(0,S.jsx)(u.A.Label,{children:"Name"}),(0,S.jsx)(h.A,{block:!0,value:O.name,onChange:e=>{q((s=>({...s,name:e.target.value})))}}),!1===K.name&&(0,S.jsx)(u.A.Validation,{variant:"error",children:"Name must have more than 2 characters."})]}),(0,S.jsxs)(u.A,{children:[(0,S.jsx)(u.A.Label,{children:"Description"}),(0,S.jsx)(m.Ay,{block:!0,value:O.description,onChange:e=>{q((s=>({...s,description:e.target.value})))}}),!1===K.description&&(0,S.jsx)(u.A.Validation,{variant:"error",children:"Description must have more than 2 characters."})]}),(0,S.jsx)(u.A,{children:(0,S.jsx)(c.Q,{variant:"primary",disabled:!K.name||!K.description,sx:{marginTop:2},onClick:async()=>{E.layout().showBackdrop(),F(s,O.name,O.description).then((e=>{E.layout().hideBackdrop(),e.success&&(M("The lesson is successfully updated.",{variant:"success"}),E.layout().triggerItemsRefresh(),J({...P,name:O.name,description:O.description}))})).finally((()=>{E.layout().hideBackdrop()}))},children:"Update lesson"})})]})})})]})]})},w=B}}]);