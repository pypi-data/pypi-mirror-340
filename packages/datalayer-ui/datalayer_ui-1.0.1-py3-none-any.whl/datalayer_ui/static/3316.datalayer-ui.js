"use strict";(self.webpackChunk_datalayer_ui=self.webpackChunk_datalayer_ui||[]).push([[3316],{25385:(e,t,n)=>{n.d(t,{f:()=>a});var a,o=n(14809),i=n(2335);!function(e){e.getBoolean=function(e){return(0,i.ui)({...e,body:new r(e),buttons:[i.lG.cancelButton({label:e.cancelLabel}),i.lG.okButton({label:e.okLabel})],focusNodeSelector:"input"})},e.getNumber=function(e){return(0,i.ui)({...e,body:new l(e),buttons:[i.lG.cancelButton({label:e.cancelLabel}),i.lG.okButton({label:e.okLabel})],focusNodeSelector:"input"})},e.getItem=function(e){return(0,i.ui)({...e,body:new u(e),buttons:[i.lG.cancelButton({label:e.cancelLabel}),i.lG.okButton({label:e.okLabel})],focusNodeSelector:e.editable?"input":"select"})},e.getMultipleItems=function(e){return(0,i.ui)({...e,body:new h(e),buttons:[i.lG.cancelButton({label:e.cancelLabel}),i.lG.okButton({label:e.okLabel})]})},e.getText=function(e){return(0,i.ui)({...e,body:new c(e),buttons:[i.lG.cancelButton({label:e.cancelLabel}),i.lG.okButton({label:e.okLabel})],focusNodeSelector:"input"})},e.getPassword=function(e){return(0,i.ui)({...e,body:new d(e),buttons:[i.lG.cancelButton({label:e.cancelLabel}),i.lG.okButton({label:e.okLabel})],focusNodeSelector:"input"})}}(a||(a={}));class s extends o.x0{constructor(e){if(super(),this.addClass("jp-Input-Dialog"),this._input=document.createElement("input"),this._input.classList.add("jp-mod-styled"),this._input.id="jp-dialog-input-id",void 0!==e){const t=document.createElement("label");t.textContent=e,t.htmlFor=this._input.id,this.node.appendChild(t)}this.node.appendChild(this._input)}}class r extends s{constructor(e){super(e.label),this.addClass("jp-Input-Boolean-Dialog"),this._input.type="checkbox",this._input.checked=!!e.value}getValue(){return this._input.checked}}class l extends s{constructor(e){super(e.label),this._input.type="number",this._input.value=e.value?e.value.toString():"0"}getValue(){return this._input.value?Number(this._input.value):Number.NaN}}class c extends s{constructor(e){var t;super(e.label),this._input.type="text",this._input.value=e.text?e.text:"",e.placeholder&&(this._input.placeholder=e.placeholder),this._initialSelectionRange=Math.min(this._input.value.length,Math.max(0,null!==(t=e.selectionRange)&&void 0!==t?t:this._input.value.length))}onAfterAttach(e){super.onAfterAttach(e),this._initialSelectionRange>0&&this._input.value&&this._input.setSelectionRange(0,this._initialSelectionRange)}getValue(){return this._input.value}}class d extends s{constructor(e){super(e.label),this._input.type="password",this._input.value=e.text?e.text:"",e.placeholder&&(this._input.placeholder=e.placeholder)}onAfterAttach(e){super.onAfterAttach(e),this._input.value&&this._input.select()}getValue(){return this._input.value}}class u extends s{constructor(e){super(e.label),this._editable=e.editable||!1;let t,n=e.current||0;if("number"==typeof n&&(t=Math.max(0,Math.min(n,e.items.length-1)),n=""),this._list=document.createElement("select"),e.items.forEach(((e,a)=>{const o=document.createElement("option");a===t&&(o.selected=!0,n=e),o.value=e,o.textContent=e,this._list.appendChild(o)})),e.editable){const t=document.createElement("datalist");t.id="input-dialog-items",t.appendChild(this._list),this._input.type="list",this._input.value=n,this._input.setAttribute("list",t.id),e.placeholder&&(this._input.placeholder=e.placeholder),this.node.appendChild(t)}else this._input.remove(),this.node.appendChild(this._list)}getValue(){return this._editable?this._input.value:this._list.value}}class h extends s{constructor(e){super(e.label);let t=e.defaults||[];this._list=document.createElement("select"),this._list.setAttribute("multiple",""),e.items.forEach((e=>{const t=document.createElement("option");t.value=e,t.textContent=e,this._list.appendChild(t)})),this._input.remove(),this.node.appendChild(this._list);const n=this._list.options;for(let e=0;e<n.length;e++){const a=n[e];t.includes(a.value)?a.selected=!0:a.selected=!1}}getValue(){let e=[];for(let t of this._list.options)t.selected&&!t.classList.contains("hidden")&&e.push(t.value||t.text);return e}}},83316:(e,t,n)=>{n.r(t),n.d(t,{ToolbarItems:()=>J,default:()=>X,downloadPlugin:()=>Q,openBrowserTabPlugin:()=>z,pathStatusPlugin:()=>H,savingStatusPlugin:()=>K});var a,o=n(19823),i=n(80955),s=n(68122),r=n(59179),l=n(80578),c=n(2335),d=n(53294),u=n(88037),h=n(8522),g=n(25385),m=n(63711),p=n(60872),_=n(49984),v=n(14377),f=n(85181),w=n(38921),b=n(98238),C=n(15503),y=n(72490),x=n(45427),F=n(39203);class S{constructor(e){var t;this._activateRequested=new y.Signal(this),this._contexts=[],this._isDisposed=!1,this._autosave=!0,this._autosaveInterval=120,this._lastModifiedCheckMargin=500,this._renameUntitledFileOnSave=!0,this._stateChanged=new y.Signal(this),this.translator=e.translator||f.wK,this.registry=e.registry,this.services=e.manager,this._dialogs=null!==(t=e.sessionDialogs)&&void 0!==t?t:new l.V({translator:e.translator}),this._isConnectedCallback=e.isConnectedCallback||(()=>!0),this._opener=e.opener,this._when=e.when||e.manager.ready;const n=new F.p({registry:this.registry,translator:this.translator});n.activateRequested.connect(this._onActivateRequested,this),n.stateChanged.connect(this._onWidgetStateChanged,this),this._widgetManager=n,this._setBusy=e.setBusy}get activateRequested(){return this._activateRequested}get autosave(){return this._autosave}set autosave(e){if(this._autosave!==e){const t=this._autosave;this._autosave=e,this._contexts.forEach((t=>{const n=a.saveHandlerProperty.get(t);n&&(!0!==e||n.isActive?!1===e&&n.isActive&&n.stop():n.start())})),this._stateChanged.emit({name:"autosave",oldValue:t,newValue:e})}}get autosaveInterval(){return this._autosaveInterval}set autosaveInterval(e){if(this._autosaveInterval!==e){const t=this._autosaveInterval;this._autosaveInterval=e,this._contexts.forEach((t=>{const n=a.saveHandlerProperty.get(t);n&&(n.saveInterval=e||120)})),this._stateChanged.emit({name:"autosaveInterval",oldValue:t,newValue:e})}}get confirmClosingDocument(){return this._widgetManager.confirmClosingDocument}set confirmClosingDocument(e){if(this._widgetManager.confirmClosingDocument!==e){const t=this._widgetManager.confirmClosingDocument;this._widgetManager.confirmClosingDocument=e,this._stateChanged.emit({name:"confirmClosingDocument",oldValue:t,newValue:e})}}get lastModifiedCheckMargin(){return this._lastModifiedCheckMargin}set lastModifiedCheckMargin(e){if(this._lastModifiedCheckMargin!==e){const t=this._lastModifiedCheckMargin;this._lastModifiedCheckMargin=e,this._contexts.forEach((t=>{t.lastModifiedCheckMargin=e})),this._stateChanged.emit({name:"lastModifiedCheckMargin",oldValue:t,newValue:e})}}get renameUntitledFileOnSave(){return this._renameUntitledFileOnSave}set renameUntitledFileOnSave(e){if(this._renameUntitledFileOnSave!==e){const t=this._renameUntitledFileOnSave;this._renameUntitledFileOnSave=e,this._stateChanged.emit({name:"renameUntitledFileOnSave",oldValue:t,newValue:e})}}get stateChanged(){return this._stateChanged}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,y.Signal.clearData(this),this._contexts.forEach((e=>this._widgetManager.closeWidgets(e))),this._widgetManager.dispose(),this._contexts.length=0)}cloneWidget(e){return this._widgetManager.cloneWidget(e)}closeAll(){return Promise.all(this._contexts.map((e=>this._widgetManager.closeWidgets(e)))).then((()=>{}))}closeFile(e){const t=this._contextsForPath(e).map((e=>this._widgetManager.closeWidgets(e)));return Promise.all(t).then((e=>{}))}contextForWidget(e){return this._widgetManager.contextForWidget(e)}copy(e,t){return this.services.contents.copy(e,t)}createNew(e,t="default",n){return this._createOrOpenDocument("create",e,t,n)}deleteFile(e){return this.services.sessions.stopIfNeeded(e).then((()=>this.services.contents.delete(e))).then((()=>(this._contextsForPath(e).forEach((e=>this._widgetManager.deleteWidgets(e))),Promise.resolve(void 0))))}duplicate(e){const t=m.PathExt.dirname(e);return this.services.contents.copy(e,t)}findWidget(e,t="default"){const n=m.PathExt.normalize(e);let a=[t];if("default"===t){const e=this.registry.defaultWidgetFactory(n);if(!e)return;a=[e.name]}else null===t&&(a=this.registry.preferredWidgetFactories(n).map((e=>e.name)));for(const e of this._contextsForPath(n))for(const t of a)if(null!==t){const n=this._widgetManager.findWidget(e,t);if(n)return n}}newUntitled(e){return"file"===e.type&&(e.ext=e.ext||".txt"),this.services.contents.newUntitled(e)}open(e,t="default",n,a){return this._createOrOpenDocument("open",e,t,n,a)}openOrReveal(e,t="default",n,a){const o=this.findWidget(e,t);return o?(this._opener.open(o,{type:t,...a}),o):this.open(e,t,n,null!=a?a:{})}overwrite(e,t){const n=`${t}.${b.UUID.uuid4()}`,a=()=>this.rename(n,t);return this.rename(e,n).then((()=>this.deleteFile(t))).then(a,a)}rename(e,t){return this.services.contents.rename(e,t)}_findContext(e,t){const n=this.services.contents.normalize(e);return(0,w.I6)(this._contexts,(e=>e.path===n&&e.factoryName===t))}_contextsForPath(e){const t=this.services.contents.normalize(e);return this._contexts.filter((e=>e.path===t))}_createContext(e,t,n){const o=new v.o({opener:(e,t)=>{this._widgetManager.adoptWidget(o,e),this._opener.open(e,t)},manager:this.services,factory:t,path:e,kernelPreference:n,setBusy:this._setBusy,sessionDialogs:this._dialogs,lastModifiedCheckMargin:this._lastModifiedCheckMargin,translator:this.translator}),i=new x.I({context:o,isConnectedCallback:this._isConnectedCallback,saveInterval:this.autosaveInterval});return a.saveHandlerProperty.set(o,i),o.ready.then((()=>{this.autosave&&i.start()})),o.disposed.connect(this._onContextDisposed,this),this._contexts.push(o),o}_onContextDisposed(e){w.Rw.removeFirstOf(this._contexts,e)}_widgetFactoryFor(e,t){const{registry:n}=this;if("default"===t){const a=n.defaultWidgetFactory(e);if(!a)return;t=a.name}return n.getWidgetFactory(t)}_createOrOpenDocument(e,t,n="default",a,o){const i=this._widgetFactoryFor(t,n);if(!i)return;const s=i.modelName||"text",r=this.registry.getModelFactory(s);if(!r)return;const l=this.registry.getKernelPreference(t,i.name,a);let c,d=Promise.resolve(void 0);if("open"===e)c=this._findContext(t,r.name)||null,c||(c=this._createContext(t,r,l),d=this._when.then((()=>c.initialize(!1))));else{if("create"!==e)throw new Error(`Invalid argument 'which': ${e}`);c=this._createContext(t,r,l),d=this._when.then((()=>c.initialize(!0)))}const u=this._widgetManager.createWidget(i,c);return this._opener.open(u,{type:i.name,...o}),d.catch((e=>{console.error(`Failed to initialize the context with '${r.name}' for ${t}`,e),u.close()})),u}_onActivateRequested(e,t){this._activateRequested.emit(t)}_onWidgetStateChanged(e,t){"confirmClosingDocument"===t.name&&this._stateChanged.emit(t)}}!function(e){e.saveHandlerProperty=new C.AttachedProperty({name:"saveHandler",create:()=>{}})}(a||(a={}));var k=n(62939),M=n(9387);function E(e){return M.createElement(k.pC,{source:e.fileStatus})}class W extends u.QX{constructor(e){super(new W.Model(e.docManager));const t=(e.translator||f.wK).load("jupyterlab");this._statusMap={completed:t.__("Saving completed"),started:t.__("Saving started"),failed:t.__("Saving failed")}}render(){return null===this.model||null===this.model.status?null:M.createElement(E,{fileStatus:this._statusMap[this.model.status]})}}function A(e){return M.createElement(k.pC,{source:e.name,title:e.fullPath})}!function(e){class t extends u.AF{constructor(e){super(),this._onStatusChange=(e,t)=>{this._status=t,"completed"===this._status?(setTimeout((()=>{this._status=null,this.stateChanged.emit(void 0)}),2e3),this.stateChanged.emit(void 0)):this.stateChanged.emit(void 0)},this._status=null,this._widget=null,this._status=null,this.widget=null,this._docManager=e}get status(){return this._status}get widget(){return this._widget}set widget(e){var t,n;const a=this._widget;if(null!==a){const e=this._docManager.contextForWidget(a);e?e.saveState.disconnect(this._onStatusChange):(null===(t=this._widget.content)||void 0===t?void 0:t.saveStateChanged)&&this._widget.content.saveStateChanged.disconnect(this._onStatusChange)}if(this._widget=e,null===this._widget)this._status=null;else{const e=this._docManager.contextForWidget(this._widget);e?e.saveState.connect(this._onStatusChange):(null===(n=this._widget.content)||void 0===n?void 0:n.saveStateChanged)&&this._widget.content.saveStateChanged.connect(this._onStatusChange)}}}e.Model=t}(W||(W={}));class D extends u.QX{constructor(e){super(new D.Model(e.docManager)),this.node.title=this.model.path}render(){return M.createElement(A,{fullPath:this.model.path,name:this.model.name})}}!function(e){class t extends u.AF{constructor(e){super(),this._onTitleChange=e=>{const t=this._getAllState();this._name=e.label,this._triggerChange(t,this._getAllState())},this._onPathChange=(e,t)=>{const n=this._getAllState();this._path=t,this._name=m.PathExt.basename(t),this._triggerChange(n,this._getAllState())},this._path="",this._name="",this._widget=null,this._docManager=e}get path(){return this._path}get name(){return this._name}get widget(){return this._widget}set widget(e){const t=this._widget;if(null!==t){const e=this._docManager.contextForWidget(t);e?e.pathChanged.disconnect(this._onPathChange):t.title.changed.disconnect(this._onTitleChange)}const n=this._getAllState();if(this._widget=e,null===this._widget)this._path="",this._name="";else{const e=this._docManager.contextForWidget(this._widget);e?(this._path=e.path,this._name=m.PathExt.basename(e.path),e.pathChanged.connect(this._onPathChange)):(this._path="",this._name=this._widget.title.label,this._widget.title.changed.connect(this._onTitleChange))}this._triggerChange(n,this._getAllState())}_getAllState(){return[this._path,this._name]}_triggerChange(e,t){e[0]===t[0]&&e[1]===t[1]||this.stateChanged.emit(void 0)}}e.Model=t}(D||(D={}));var B,R,P=n(48561),N=n(69584),I=n(20492),O=n(14809),V=n(19080);!function(e){e.clearRecents="docmanager:clear-recents"}(B||(B={})),function(e){e.recentsManager="@jupyterlab/docmanager-extension:recents",e.reopenClosed="@jupyterlab/docmanager-extension:reopen-recently-closed",e.mainPlugin="@jupyterlab/docmanager-extension:plugin"}(R||(R={}));const j={id:R.recentsManager,description:"Provides a manager of recently opened and closed documents.",autoStart:!0,requires:[V.IStateDB],optional:[N.X,f.sQ],provides:_.IRecentsManager,activate:(e,t,n,a)=>{const{serviceManager:o}=e,i=(null!=a?a:f.wK).load("jupyterlab"),s=new _.RecentsManager({stateDB:t,contents:o.contents}),r=e=>{s.maximalRecentsLength=e.get("maxNumberRecents").composite};return n&&Promise.all([e.restored,n.load(R.mainPlugin)]).then((([e,t])=>{t.changed.connect(r),r(t)})),e.commands.addCommand(B.clearRecents,{execute:()=>{s.clearRecents()},isEnabled:()=>0!=s.recentlyOpened.length||0!=s.recentlyClosed.length,label:i.__("Clear Recent Documents"),caption:i.__("Clear the list of recently opened items.")}),s}};var T;!function(e){e.clone="docmanager:clone",e.deleteFile="docmanager:delete-file",e.newUntitled="docmanager:new-untitled",e.open="docmanager:open",e.openBrowserTab="docmanager:open-browser-tab",e.reload="docmanager:reload",e.rename="docmanager:rename",e.del="docmanager:delete",e.duplicate="docmanager:duplicate",e.restoreCheckpoint="docmanager:restore-checkpoint",e.save="docmanager:save",e.saveAll="docmanager:save-all",e.saveAs="docmanager:save-as",e.download="docmanager:download",e.toggleAutosave="docmanager:toggle-autosave",e.showInFileBrowser="docmanager:show-in-file-browser"}(T||(T={}));const G="@jupyterlab/docmanager-extension:plugin",U={id:"@jupyterlab/docmanager-extension:opener",description:"Provides the widget opener.",autoStart:!0,provides:p.g,activate:e=>{const{shell:t}=e;return new class{constructor(){this._opened=new y.Signal(this)}open(e,n){e.id||(e.id="document-manager-"+ ++Y.id),e.title.dataset={type:"document-title",...e.title.dataset},e.isAttached||t.add(e,"main",n||{}),t.activateById(e.id),this._opened.emit(e)}get opened(){return this._opened}}}},$={id:"@jupyterlab/docmanager-extension:contexts",description:"Adds the handling of opened documents dirty state.",autoStart:!0,requires:[p.c,p.g],optional:[o.n3],activate:(e,t,n,a)=>{const o=new WeakSet;n.opened.connect(((e,n)=>{const i=t.contextForWidget(n);i&&!o.has(i)&&(a&&function(e,t){let n=null;const a=(t,a)=>{"dirty"===a.name&&(!0===a.newValue?n||(n=e.setDirty()):n&&(n.dispose(),n=null))};t.ready.then((()=>{t.model.stateChanged.connect(a),t.model.dirty&&(n=e.setDirty())})),t.disposed.connect((()=>{n&&n.dispose()}))}(a,i),o.add(i))}))}},L={id:"@jupyterlab/docmanager-extension:manager",description:"Provides the document manager.",provides:p.c,requires:[p.g],optional:[f.sQ,o.n3,r.i_,i.n.IInfo,_.IRecentsManager],activate:(e,t,n,a,o,i,s)=>{var r;const{serviceManager:c,docRegistry:d}=e,u=null!=n?n:f.wK,h=null!=o?o:new l.V({translator:u}),g=e.restored.then((()=>{}));return new S({registry:d,manager:c,opener:t,when:g,setBusy:null!==(r=a&&(()=>a.setBusy()))&&void 0!==r?r:void 0,sessionDialogs:h,translator:null!=u?u:f.wK,isConnectedCallback:()=>!i||i.isConnected,recentsManager:null!=s?s:void 0})}},q={id:G,description:"Adds commands and settings to the document manager.",autoStart:!0,requires:[p.c,p.g,N.X],optional:[f.sQ,r.kn,s.V],activate:(e,t,n,a,o,i,s)=>{const r=(o=null!=o?o:f.wK).load("jupyterlab"),l=e.docRegistry;!function(e,t,n,a,o,i,s){var r;const l=o.load("jupyterlab"),{commands:d,shell:u}=e,p=l.__("File Operations"),_=()=>{const{currentWidget:e}=u;return!(!e||!t.contextForWidget(e))},v=()=>{var e;const{currentWidget:n}=u;if(!n)return!1;const a=t.contextForWidget(n);return!!(null===(e=null==a?void 0:a.contentsModel)||void 0===e?void 0:e.writable)},f=e=>h.E.warning(l.__('%1 is read-only. Use "Save as…" instead.',e),{autoClose:5e3});i&&function(e,t,n,a,o){const i=o.load("jupyterlab"),{commands:s}=e,r=()=>{var a;const o=/[Pp]ath:\s?(.*)\n?/,i=e.contextMenuHitTest((e=>{var t;return!!(null===(t=e.title)||void 0===t?void 0:t.match(o))})),s=null==i?void 0:i.title.match(o);return null!==(a=s&&t.findWidget(s[1],null))&&void 0!==a?a:n.currentWidget},l=()=>{const{currentWidget:e}=n;return!(!e||!t.contextForWidget(e))};s.addCommand(T.clone,{label:()=>i.__("New View for %1",ee(r(),t)),isEnabled:l,execute:e=>{const n=r(),o=e.options||{mode:"split-right"};if(!n)return;const i=t.cloneWidget(n);i&&a.open(i,o)}}),s.addCommand(T.rename,{label:()=>{let e=ee(r(),t);return e&&(e=" "+e),i.__("Rename%1…",e)},isEnabled:l,execute:()=>{if(l()){const e=t.contextForWidget(r());return(0,P.J3)(t,e)}}}),s.addCommand(T.duplicate,{label:()=>i.__("Duplicate %1",ee(r(),t)),isEnabled:l,execute:()=>{if(l()){const e=t.contextForWidget(r());if(!e)return;return t.duplicate(e.path)}}}),s.addCommand(T.del,{label:()=>i.__("Delete %1",ee(r(),t)),isEnabled:l,execute:async()=>{if(l()){const n=t.contextForWidget(r());if(!n)return;(await(0,c.ui)({title:i.__("Delete"),body:i.__("Are you sure you want to delete %1",n.path),buttons:[c.lG.cancelButton(),c.lG.warnButton({label:i.__("Delete")})]})).button.accept&&await e.commands.execute("docmanager:delete-file",{path:n.path})}}}),s.addCommand(T.showInFileBrowser,{label:()=>i.__("Show in File Browser"),isEnabled:l,execute:async()=>{const e=r(),n=e&&t.contextForWidget(e);n&&(await s.execute("filebrowser:activate",{path:n.path}),await s.execute("filebrowser:go-to-path",{path:n.path}))}}),n.currentChanged.connect((()=>{[T.clone,T.rename,T.duplicate,T.del,T.showInFileBrowser].forEach((t=>{e.commands.notifyCommandChanged(t)}))}))}(e,t,i,n,o),d.addCommand(T.deleteFile,{label:()=>`Delete ${ee(u.currentWidget,t)}`,execute:e=>{const n=void 0===e.path?"":e.path;if(!n){const e=T.deleteFile;throw new Error(`A non-empty path is required for ${e}.`)}return t.deleteFile(n)}}),d.addCommand(T.newUntitled,{execute:async e=>{const n=e.error||l.__("Error"),a=void 0===e.path?"":e.path,o={type:e.type,path:a};return"file"===e.type&&(o.ext=e.ext||".txt"),t.services.contents.newUntitled(o).catch((e=>(0,c.f1)(n,e)))},label:e=>e.label||`New ${e.type}`}),d.addCommand(T.open,{execute:async e=>{const n=void 0===e.path?"":e.path,a=e.factory||void 0,o=null==e?void 0:e.kernel,i=e.options||void 0;return t.services.contents.get(n,{content:!1}).then((()=>t.openOrReveal(n,a,o,i)))},iconClass:e=>e.icon||"",label:e=>{var t;return null!==(t=e.label||e.factory)&&void 0!==t?t:l.__("Open the provided `path`.")},mnemonic:e=>e.mnemonic||-1}),d.addCommand(T.reload,{label:()=>l.__("Reload %1 from Disk",ee(u.currentWidget,t)),caption:l.__("Reload contents from disk"),isEnabled:_,execute:()=>{if(!_())return;const e=t.contextForWidget(u.currentWidget),n=ee(u.currentWidget,t);return e?e.model.dirty?(0,c.ui)({title:l.__("Reload %1 from Disk",n),body:l.__("Are you sure you want to reload the %1 from the disk?",n),buttons:[c.lG.cancelButton(),c.lG.warnButton({label:l.__("Reload")})]}).then((t=>{if(t.button.accept&&!e.isDisposed)return e.revert()})):e.isDisposed?void 0:e.revert():(0,c.ui)({title:l.__("Cannot Reload"),body:l.__("No context found for current widget!"),buttons:[c.lG.okButton()]})}}),d.addCommand(T.restoreCheckpoint,{label:()=>l.__("Revert %1 to Checkpoint…",ee(u.currentWidget,t)),caption:l.__("Revert contents to previous checkpoint"),isEnabled:_,execute:()=>{if(!_())return;const e=t.contextForWidget(u.currentWidget);return e?e.listCheckpoints().then((async n=>{const a=ee(u.currentWidget,t);if(n.length<1)return void await(0,c.f1)(l.__("No checkpoints"),l.__("No checkpoints are available for this %1.",a));const o=1===n.length?n[0]:await Y.getTargetCheckpoint(n.reverse(),l);return o?(0,c.ui)({title:l.__("Revert %1 to checkpoint",a),body:new Z(o,l,a),buttons:[c.lG.cancelButton(),c.lG.warnButton({label:l.__("Revert"),ariaLabel:l.__("Revert to Checkpoint")})]}).then((t=>{if(!e.isDisposed)return t.button.accept?e.model.readOnly?e.revert():e.restoreCheckpoint(o.id).then((()=>e.revert())):void 0})):void 0})):(0,c.ui)({title:l.__("Cannot Revert"),body:l.__("No context found for current widget!"),buttons:[c.lG.okButton()]})}});const b=new WeakSet;d.addCommand(T.save,{label:()=>l.__("Save %1",ee(u.currentWidget,t)),caption:()=>{if(u.currentWidget){const e=t.contextForWidget(u.currentWidget);if(null==e?void 0:e.model.collaborative)return l.__("In collaborative mode, the document is saved automatically after every change");if(!v())return l.__('Document is read-only. "Save" is disabled; use "Save as…" instead')}return l.__("Save and create checkpoint")},icon:e=>e.toolbar?I.DL:void 0,isEnabled:e=>e._luminoEvent&&"keybinding"===e._luminoEvent.type||v(),execute:async e=>{var n,o,i,s,r;const d=u.currentWidget,h=t.contextForWidget(d);if(_()){if(!h)return(0,c.ui)({title:l.__("Cannot Save"),body:l.__("No context found for current widget!"),buttons:[c.lG.okButton()]});{if(b.has(h))return;if(!(null===(n=h.contentsModel)||void 0===n?void 0:n.writable)){let t=null===(o=e._luminoEvent)||void 0===o?void 0:o.type;return e._luminoEvent&&"keybinding"===t?void f(h.path):(0,c.ui)({title:l.__("Cannot Save"),body:l.__("Document is read-only"),buttons:[c.lG.okButton()]})}b.add(h);const u=m.PathExt.basename(null!==(s=null===(i=h.contentsModel)||void 0===i?void 0:i.path)&&void 0!==s?s:"");let p=u;if(t.renameUntitledFileOnSave&&!0===d.isUntitled){const e=await g.f.getText({title:l.__("Rename file"),okLabel:l.__("Rename and Save"),placeholder:l.__("File name"),text:u,selectionRange:u.length-m.PathExt.extname(u).length,checkbox:{label:l.__("Do not ask for rename on first save."),caption:l.__("If checked, you will not be asked to rename future untitled files when saving them.")}});if(e.button.accept&&(p=null!==(r=e.value)&&void 0!==r?r:u,d.isUntitled=!1,"boolean"==typeof e.isChecked)){const t=(await a.get(G,"renameUntitledFileOnSave")).composite;e.isChecked===t&&a.set(G,"renameUntitledFileOnSave",!e.isChecked).catch((e=>{console.error(`Fail to set 'renameUntitledFileOnSave:\n${e}`)}))}}try{if(await h.save(),!(null==d?void 0:d.isDisposed))return h.createCheckpoint()}catch(e){if("ModalCancelError"===e.name)return;throw e}finally{b.delete(h),p!==u&&await h.rename(p)}}}}}),d.addCommand(T.saveAll,{label:()=>l.__("Save All"),caption:l.__("Save all open documents"),isEnabled:()=>(0,w.zN)(u.widgets("main"),(e=>{var n,a,o;return null!==(o=null===(a=null===(n=t.contextForWidget(e))||void 0===n?void 0:n.contentsModel)||void 0===a?void 0:a.writable)&&void 0!==o&&o})),execute:()=>{var e;const n=[],a=new Set;for(const o of u.widgets("main")){const i=t.contextForWidget(o);i&&!a.has(i.path)&&((null===(e=i.contentsModel)||void 0===e?void 0:e.writable)?(a.add(i.path),n.push(i.save())):f(i.path))}return Promise.all(n)}}),d.addCommand(T.saveAs,{label:()=>l.__("Save %1 As…",ee(u.currentWidget,t)),caption:l.__("Save with new path"),isEnabled:_,execute:()=>{if(_()){const e=t.contextForWidget(u.currentWidget);if(!e)return(0,c.ui)({title:l.__("Cannot Save"),body:l.__("No context found for current widget!"),buttons:[c.lG.okButton()]});const n=(n,a)=>{"save"===a.type&&a.newValue&&a.newValue.path!==e.path&&(t.closeFile(e.path),d.execute(T.open,{path:a.newValue.path}))};t.services.contents.fileChanged.connect(n),e.saveAs().finally((()=>t.services.contents.fileChanged.disconnect(n)))}}}),null===(r=e.shell.currentChanged)||void 0===r||r.connect((()=>{[T.reload,T.restoreCheckpoint,T.save,T.saveAll,T.saveAs].forEach((t=>{e.commands.notifyCommandChanged(t)}))})),d.addCommand(T.toggleAutosave,{label:l.__("Autosave Documents"),isToggled:()=>t.autosave,execute:()=>{const e=!t.autosave,n="autosave";return a.set(G,n,e).catch((e=>{console.error(`Failed to set ${G}:${n} - ${e.message}`)}))}}),s&&[T.reload,T.restoreCheckpoint,T.save,T.saveAs,T.toggleAutosave,T.duplicate].forEach((e=>{s.addItem({command:e,category:p})}))}(e,t,n,a,o,s,i);const d=n=>{const a=n.get("autosave").composite;t.autosave=!0!==a&&!1!==a||a,e.commands.notifyCommandChanged(T.toggleAutosave);const o=n.get("confirmClosingDocument").composite;t.confirmClosingDocument=null==o||o;const i=n.get("autosaveInterval").composite;t.autosaveInterval=i||120;const s=n.get("lastModifiedCheckMargin").composite;t.lastModifiedCheckMargin=s||500;const r=n.get("renameUntitledFileOnSave").composite;t.renameUntitledFileOnSave=null==r||r;const c=n.get("defaultViewers").composite,d={};Object.keys(c).forEach((e=>{l.getFileType(e)?(l.getWidgetFactory(c[e])||console.warn(`Document viewer ${c[e]} not found`),d[e]=c[e]):console.warn(`File Type ${e} not found`)}));for(const e of l.fileTypes())try{l.setDefaultWidgetFactory(e.name,d[e.name])}catch(t){console.warn(`Failed to set default viewer ${d[e.name]} for file type ${e.name}`)}};Promise.all([a.load(G),e.restored]).then((([e])=>{e.changed.connect(d),d(e),t.stateChanged.connect(((t,n)=>{["autosave","autosaveInterval","confirmClosingDocument","lastModifiedCheckMargin","renameUntitledFileOnSave"].includes(n.name)&&e.get(n.name).composite!==n.newValue&&e.set(n.name,n.newValue).catch((e=>{console.error(`Failed to set the setting '${n.name}':\n${e}`)}))}))})).catch((e=>{console.error(e.message)})),a.transform(G,{fetch:e=>{const t=Array.from(l.fileTypes()).map((e=>e.name)).join("    \n"),n=Array.from(l.widgetFactories()).map((e=>e.name)).join("    \n"),a=r.__('Overrides for the default viewers for file types.\nSpecify a mapping from file type name to document viewer name, for example:\n\ndefaultViewers: {\n  markdown: "Markdown Preview"\n}\n\nIf you specify non-existent file types or viewers, or if a viewer cannot\nopen a given file type, the override will not function.\n\nAvailable viewers:\n%1\n\nAvailable file types:\n%2',n,t),o=b.JSONExt.deepCopy(e.schema);return o.properties.defaultViewers.description=a,{...e,schema:o}}}),l.changed.connect((()=>a.load(G,!0)))}},K={id:"@jupyterlab/docmanager-extension:saving-status",description:"Adds a saving status indicator.",autoStart:!0,requires:[p.c,s.V],optional:[f.sQ,k.$O],activate:(e,t,n,a,o)=>{if(!o)return;const i=new W({docManager:t,translator:null!=a?a:f.wK});i.model.widget=n.currentWidget,n.currentChanged.connect((()=>{i.model.widget=n.currentWidget})),o.registerStatusItem(K.id,{item:i,align:"middle",isActive:()=>null!==i.model&&null!==i.model.status,activeStateChanged:i.model.stateChanged})}},H={id:"@jupyterlab/docmanager-extension:path-status",description:"Adds a file path indicator in the status bar.",autoStart:!0,requires:[p.c,s.V],optional:[k.$O],activate:(e,t,n,a)=>{if(!a)return;const o=new D({docManager:t});o.model.widget=n.currentWidget,n.currentChanged.connect((()=>{o.model.widget=n.currentWidget})),a.registerStatusItem(H.id,{item:o,align:"right",rank:0})}},Q={id:"@jupyterlab/docmanager-extension:download",description:"Adds command to download files.",autoStart:!0,requires:[p.c],optional:[f.sQ,r.kn],activate:(e,t,n,a)=>{var o;const i=(null!=n?n:f.wK).load("jupyterlab"),{commands:s,shell:r}=e,l=()=>{const{currentWidget:e}=r;return!(!e||!t.contextForWidget(e))};s.addCommand(T.download,{label:i.__("Download"),caption:i.__("Download the file to your computer"),isEnabled:l,execute:()=>{if(l()){const e=t.contextForWidget(r.currentWidget);return e?e.download():(0,c.ui)({title:i.__("Cannot Download"),body:i.__("No context found for current widget!"),buttons:[c.lG.okButton()]})}}}),null===(o=e.shell.currentChanged)||void 0===o||o.connect((()=>{e.commands.notifyCommandChanged(T.download)}));const d=i.__("File Operations");a&&a.addItem({command:T.download,category:d})}},z={id:"@jupyterlab/docmanager-extension:open-browser-tab",description:"Adds command to open a browser tab.",autoStart:!0,requires:[p.c],optional:[f.sQ],activate:(e,t,n)=>{const a=(null!=n?n:f.wK).load("jupyterlab"),{commands:o}=e;o.addCommand(T.openBrowserTab,{execute:e=>{const n=void 0===e.path?"":e.path;if(n)return t.services.contents.getDownloadUrl(n).then((e=>{const t=window.open();if(!t)throw new Error("Failed to open new browser tab.");t.opener=null,t.location.href=e}))},iconClass:e=>e.icon||"",label:()=>a.__("Open in New Browser Tab")})}},X=[L,q,$,H,K,Q,z,U,j];var J,Y;!function(e){e.createSaveButton=function(e,t){return(0,d.SC)(u._Q.create(M.createElement(u.mE,{signal:t},(()=>M.createElement(d.gB,{commands:e,id:T.save,label:"",args:{toolbar:!0}})))))}}(J||(J={}));class Z extends O.x0{constructor(e,t,n="notebook"){super({node:Y.createRevertConfirmNode(e,n,t)})}}function ee(e,t){if(!e)return"File";const n=t.contextForWidget(e);if(!n)return"";const a=t.registry.getFileTypesForPath(n.path);return a.length&&a[0].displayName?a[0].displayName:"File"}!function(e){e.id=0,e.createRevertConfirmNode=function(e,t,n){const a=document.createElement("div"),o=document.createElement("p"),i=document.createTextNode(n.__("Are you sure you want to revert the %1 to checkpoint? ",t)),s=document.createElement("strong");s.textContent=n.__("This cannot be undone."),o.appendChild(i),o.appendChild(s);const r=document.createElement("p"),l=document.createTextNode(n.__("The checkpoint was last updated at: ")),c=document.createElement("p"),d=new Date(e.last_modified);return c.style.textAlign="center",c.textContent=m.Time.format(d)+" ("+m.Time.formatHuman(d)+")",r.appendChild(l),r.appendChild(c),a.appendChild(o),a.appendChild(r),a},e.getTargetCheckpoint=async function(e,t){const n=e.map(((e,t)=>`${t}. ${m.Time.format(e.last_modified)} (${m.Time.formatHuman(e.last_modified)})`)),a=(await g.f.getItem({items:n,title:t.__("Choose a checkpoint")})).value;if(!a)return;const o=a.split(".",1)[0];return e[parseInt(o,10)]}}(Y||(Y={}))},48561:(e,t,n)=>{n.d(t,{H5:()=>c,Ix:()=>u,J3:()=>l,f:()=>d});var a,o=n(2335),i=n(63711),s=n(85181),r=n(14809);function l(e,t,n){const a=(n=n||s.wK).load("jupyterlab"),i=t.localPath.split("/").pop()||t.localPath;return(0,o.ui)({title:a.__("Rename File"),body:new h(i),focusNodeSelector:"input",buttons:[o.lG.cancelButton(),o.lG.okButton({label:a.__("Rename"),ariaLabel:a.__("Rename File")})]}).then((e=>e.value?u(e.value)?t.rename(e.value):((0,o.f1)(a.__("Rename Error"),Error(a.__('"%1" is not a valid name for a file. Names must have nonzero length, and cannot include "/", "\\", or ":"',e.value))),null):null))}function c(e,t,n){return e.rename(t,n).catch((a=>{if(409!==a.response.status)throw a;return d(n).then((a=>a?e.overwrite(t,n):Promise.reject("File not renamed")))}))}function d(e,t){const n=(t=t||s.wK).load("jupyterlab"),a={title:n.__("Overwrite file?"),body:n.__('"%1" already exists, overwrite?',e),buttons:[o.lG.cancelButton(),o.lG.warnButton({label:n.__("Overwrite"),ariaLabel:n.__("Overwrite Existing File")})]};return(0,o.ui)(a).then((e=>Promise.resolve(e.button.accept)))}function u(e){return e.length>0&&!/[\/\\:]/.test(e)}class h extends r.x0{constructor(e){super({node:a.createRenameNode(e)}),this.addClass("jp-FileDialog");const t=i.PathExt.extname(e),n=this.inputNode.value=i.PathExt.basename(e);this.inputNode.setSelectionRange(0,n.length-t.length)}get inputNode(){return this.node.getElementsByTagName("input")[0]}getValue(){return this.inputNode.value}}!function(e){e.createRenameNode=function(e,t){const n=(t=t||s.wK).load("jupyterlab"),a=document.createElement("div"),o=document.createElement("label");o.textContent=n.__("File Path");const i=document.createElement("span");i.textContent=e;const r=document.createElement("label");r.textContent=n.__("New Name"),r.className="jp-new-name-title";const l=document.createElement("input");return a.appendChild(o),a.appendChild(i),a.appendChild(r),a.appendChild(l),a}}(a||(a={}))},49984:()=>{}}]);