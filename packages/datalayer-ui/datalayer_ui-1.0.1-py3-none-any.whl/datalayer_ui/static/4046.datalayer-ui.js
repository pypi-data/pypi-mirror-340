"use strict";(self.webpackChunk_datalayer_ui=self.webpackChunk_datalayer_ui||[]).push([[4046],{84046:(e,t,i)=>{i.r(t),i.d(t,{default:()=>$});var n=i(4279),s=i(53294),o=i(52556);const r="CompletionProvider:context";class l{constructor(){this.identifier=r,this.rank=500,this.renderer=null}async isApplicable(e){return!0}fetch(e,t){const i=t.editor;return i?new Promise((e=>{e(a.contextHint(i))})):Promise.reject("No editor")}}var a;!function(e){e.contextHint=function(e){const t=e.getTokenAtCursor(),i=function(e,t){return t.getTokens().filter((t=>0===t.value.indexOf(e.value)&&t.value!==e.value))}(t,e).filter((e=>e.type)).map((e=>e.value)),n=new Set(i),s=new Array;return n.forEach((e=>s.push({label:e}))),{start:t.offset,end:t.offset+t.value.length,items:s}}}(a||(a={}));var d=i(71784),c=i(85181),h=i(20492);class m{constructor(e){this.options=e,this.identifier="@jupyterlab/inline-completer:history",this._maxSuggestions=100;const t=e.translator||c.wK;this._trans=t.load("jupyterlab")}get name(){return this._trans.__("History")}get icon(){return h.oc}get schema(){return{properties:{maxSuggestions:{title:this._trans.__("Maximum number of suggestions"),description:this._trans.__("The maximum number of suggestions to retrieve from history."),type:"number"}},default:{enabled:!1,maxSuggestions:100}}}configure(e){var t;this._maxSuggestions=null!==(t=e.maxSuggestions)&&void 0!==t?t:100}async fetch(e,t,i){var n;const s=null===(n=t.session)||void 0===n?void 0:n.kernel;if(!s)throw new Error("No kernel for completion request.");const o=e.text.slice(0,e.offset).split("\n").slice(-1)[0],r={output:!1,raw:!0,hist_access_type:"search",pattern:o+"*",unique:!0,n:this._maxSuggestions},l=await s.requestHistory(r),a=[];if(""===o)return{items:[]};if("ok"===l.content.status)for(const e of l.content.history){const t=e[2].split("\n");for(let e=0;e<t.length;e++){const i=t[e];if(i.startsWith(o)){const n=i.slice(o.length,i.length)+"\n"+t.slice(e+1).join("\n");a.push({insertText:n})}}}return{items:a}}}var u,p=i(14809),v=i(72490),g=i(60639),f=i(20137),_=i(66087);class y{constructor(e){this.options=e}placeGhost(e,t){const i=[u.addMark.of(t)];e.state.field(u.markField,!1)||(i.push(_.Pe.appendConfig.of([u.markField])),i.push(_.Pe.appendConfig.of([f.Lz.domEventHandlers({blur:t=>{if(!1===this.options.onBlur(t))return!0;const i=[u.removeMark.of(null)];setTimeout((()=>{e.dispatch({effects:i})}),0)}})]))),e.dispatch({effects:i})}clearGhosts(e){const t=[u.removeMark.of(null)];e.dispatch({effects:t})}}y.streamingAnimation="uncover";class w extends f.xO{constructor(e){super(),this.options=e,this.isSpacer=!1}eq(e){return e.content==this.content&&e.options.streaming===this.options.streaming}get lineBreaks(){return(this.content.match(/\n/g)||"").length}updateDOM(e,t){return this._updateDOM(e),!0}get content(){return this.options.content}toDOM(){let e=document.createElement("span");return this.options.onPointerOver&&e.addEventListener("pointerover",this.options.onPointerOver),this.options.onPointerLeave&&e.addEventListener("pointerleave",this.options.onPointerLeave),e.classList.add("jp-GhostText"),e.dataset.animation=y.streamingAnimation,e.dataset.providedBy=this.options.providerId,this._updateDOM(e),e}_updateDOM(e){const t=this.content;let i=this.options.addedPart;if(i&&!this.isSpacer){i.startsWith("\n")&&(i=i.substring(1)),e.innerText=t.substring(0,t.length-i.length);const n=document.createElement("span");n.className="jp-GhostText-streamedToken",n.innerText=i,e.appendChild(n)}else e.innerText=t;if(!this.isSpacer&&this.options.streaming){const t=document.createElement("span");t.className="jp-GhostText-streamingIndicator",e.appendChild(t)}}destroy(e){this.options.onPointerOver&&e.removeEventListener("pointerover",this.options.onPointerOver),this.options.onPointerLeave&&e.removeEventListener("pointerleave",this.options.onPointerLeave),super.destroy(e)}}class x extends w{constructor(){super(...arguments),this.isSpacer=!0}}class C extends x{toDOM(){const e=super.toDOM();return e.classList.add("jp-GhostText-lineSpacer"),e}}class b extends x{get content(){return this.options.content[0]}toDOM(){const e=super.toDOM();return e.classList.add("jp-GhostText-letterSpacer"),e}}!function(e){let t;function i(e,t){return f.NZ.widget({widget:new w(e),side:1,ghostSpec:e}).range(Math.min(e.from,t.newDoc.length),Math.min(e.from,t.newDoc.length))}!function(e){e[e.Set=0]="Set",e[e.Remove=1]="Remove",e[e.FilterAndUpdate=2]="FilterAndUpdate"}(t||(t={})),e.addMark=_.Pe.define({map:(e,t)=>({...e,from:t.mapPos(e.from),to:t.mapPos(e.from+e.content.length)})}),e.removeMark=_.Pe.define(),e.markField=_.sU.define({create:()=>f.NZ.none,update(n,s){const o=function(i){for(let n of i.effects){if(n.is(e.addMark))return{action:t.Set,spec:n.value};if(n.is(e.removeMark))return{action:t.Remove}}return i.docChanged||i.selection?{action:t.FilterAndUpdate}:null}(s);if(n=n.update({filter:(e,t,i)=>!(i.spec.widget instanceof x&&i.spec.timeoutInfo.elapsed)}),!o)return n.map(s.changes);switch(o.action){case t.Set:{const e=i(o.spec,s);return n.update({add:[e],filter:(t,i,n)=>n===e.value})}case t.Remove:return n.update({filter:()=>!1});case t.FilterAndUpdate:{let e=n.iter();for(;e.value&&e.value.spec.widget instanceof x;)e.next();if(!e.value)return n.map(s.changes);const t=e.value.spec.ghostSpec,o={...t};let r=!1;s.changes.iterChanges(((e,t,i,n,s)=>{if(!r)if(e===t&&i!==n)for(let e=0;e<s.lines;e++){const t=s.lineAt(e).text,i=e>0?"\n"+t:t;if(!o.content.startsWith(i)){r=!0;break}o.content=o.content.slice(i.length),o.from+=i.length}else r=!0}));const l=r?function(e,t,i=1e3){if(e.content.length<2)return[];const n={elapsed:!1};setTimeout((()=>{n.elapsed=!0}),i);const s=f.NZ.widget({widget:new b(e),side:1,timeoutInfo:n}),o=f.NZ.widget({widget:new C(e),side:1,timeoutInfo:n});return[s.range(Math.min(e.from,t.newDoc.length),Math.min(e.from,t.newDoc.length)),o.range(Math.min(e.from,t.newDoc.length),Math.min(e.from,t.newDoc.length))]}(t,s):[i(o,s)],a=l.map((e=>e.value));if(n=n.update({add:l,filter:(e,t,i)=>a.includes(i)}),r)try{n=n.map(s.changes)}catch(e){return console.warn(e),f.NZ.none}return n}}},provide:e=>f.Lz.decorations.from(e)})}(u||(u={}));const P="jp-InlineCompleter-hover";class k extends p.x0{constructor(e){var t,i;super({node:document.createElement("div")}),this._clearHoverTimeout=null,this._current=0,this._editor=null,this._lastItem=null,this._model=null,this._providerWidget=new p.x0,this._showShortcuts=k.defaultSettings.showShortcuts,this._showWidget=k.defaultSettings.showWidget,this._suggestionsCounter=new p.x0,this._toolbar=new s.M7,this.model=null!==(t=e.model)&&void 0!==t?t:null,this.editor=null!==(i=e.editor)&&void 0!==i?i:null,this.addClass("jp-InlineCompleter"),this._ghostManager=new y({onBlur:this._onEditorBlur.bind(this)}),this._trans=e.trans;const n=this.layout=new p.DG;n.addWidget(this._suggestionsCounter),n.addWidget(this.toolbar),n.addWidget(this._providerWidget),this._progressBar=document.createElement("div"),this._progressBar.className="jp-InlineCompleter-progressBar",this.node.appendChild(this._progressBar),this._updateShortcutsVisibility(),this._updateDisplay(),this.node.tabIndex=0}get toolbar(){return this._toolbar}get editor(){return this._editor}set editor(e){var t;null===(t=this.model)||void 0===t||t.reset(),this._editor=e}get model(){return this._model}set model(e){(e||this._model)&&e!==this._model&&(this._model&&(this._model.suggestionsChanged.disconnect(this._onModelSuggestionsChanged,this),this._model.filterTextChanged.disconnect(this._onModelFilterTextChanged,this),this._model.provisionProgress.disconnect(this._onProvisionProgress,this)),this._model=e,this._model&&(this._model.suggestionsChanged.connect(this._onModelSuggestionsChanged,this),this._model.filterTextChanged.connect(this._onModelFilterTextChanged,this),this._model.provisionProgress.connect(this._onProvisionProgress,this)))}cycle(e){var t,i;const n=null===(i=null===(t=this.model)||void 0===t?void 0:t.completions)||void 0===i?void 0:i.items;if(n){if("next"===e){const e=this._current+1;this._current=e===n.length?0:e}else{const e=this._current-1;this._current=-1===e?n.length-1:e}this._updateStreamTracking(),this._render()}}accept(){const e=this.model,t=this.current,i=this._editor;if(!i||!e||!t)return;const n=e.cursor,s=t.insertText,o=i.getOffsetAt(i.getCursorPosition()),r=i.getOffsetAt(n),l=r,a=o;i.model.sharedModel.updateSource(r,o,s),o<=a&&o>=l&&i.setCursorPosition(i.getPositionAt(l+s.length)),e.reset(),this.update()}get current(){var e;const t=null===(e=this.model)||void 0===e?void 0:e.completions;return t?t.items[this._current]:null}_updateStreamTracking(){this._lastItem&&this._lastItem.stream.disconnect(this._onStream,this);const e=this.current;e&&e.stream.connect(this._onStream,this),this._lastItem=e}_onStream(e,t){var i;const n=null===(i=this.model)||void 0===i?void 0:i.completions;if(!n||!n.items||0===n.items.length)return;if(this.isHidden)return;const s=n.items[this._current];this._setText(s)}configure(e){this._showWidget=e.showWidget,this._updateDisplay(),e.showShortcuts!==this._showShortcuts&&(this._showShortcuts=e.showShortcuts,this._updateShortcutsVisibility()),y.streamingAnimation=e.streamingAnimation}handleEvent(e){if(!this.isHidden&&this._editor)switch(e.type){case"pointerdown":this._evtPointerdown(e);break;case"scroll":this._evtScroll(e)}}onUpdateRequest(e){super.onUpdateRequest(e);const t=this._model;if(!t)return;let i=t.completions;i&&i.items&&0!==i.items.length?this.isHidden&&(this.show(),this._setGeometry()):this.isHidden||this.hide()}onAfterAttach(e){document.addEventListener("scroll",this,!0),document.addEventListener("pointerdown",this,!0)}onBeforeDetach(e){document.removeEventListener("scroll",this,!0),document.removeEventListener("pointerdown",this,!0)}_evtPointerdown(e){var t;if(this.isHidden||!this._editor)return;const i=e.target;if(this.node.contains(i))return!0;this.hide(),null===(t=this.model)||void 0===t||t.reset()}_evtScroll(e){if(this.isHidden||!this._editor)return;const{node:t}=this;t.contains(e.target)||requestAnimationFrame((()=>{this._setGeometry()}))}_onEditorBlur(e){if(this.node.contains(e.relatedTarget))return!1;this.hide()}_onModelSuggestionsChanged(e,t){var i;if(this.isAttached){if("set"===t.event)this._current=null!==(i=t.indexMap.get(this._current))&&void 0!==i?i:0;else if("clear"===t.event){const e=this.editor;e&&this._ghostManager.clearGhosts(e.editor)}this._updateStreamTracking(),this.update(),this._render()}else this.update()}_onModelFilterTextChanged(e,t){var i,n;const s=null===(i=this.model)||void 0===i?void 0:i.completions;s&&s.items&&0!==s.items.length&&(this._current=null!==(n=t.get(this._current))&&void 0!==n?n:0,this._updateStreamTracking(),setTimeout((()=>{this._render(),this._setGeometry()}),0))}_onProvisionProgress(e,t){requestAnimationFrame((()=>{0===t.pendingProviders?this._progressBar.style.display="none":(this._progressBar.style.display="",this._progressBar.style.width=100*t.pendingProviders/t.totalProviders+"%")}))}_render(){var e,t;const i=null===(e=this.model)||void 0===e?void 0:e.completions;if(!i||!i.items||0===i.items.length)return;const n=i.items[this._current];this._setText(n),"never"!==this._showWidget&&(this._suggestionsCounter.node.innerText=this._trans.__("%1/%2",this._current+1,i.items.length),this._providerWidget.node.title=this._trans.__("Provider: %1",n.provider.name),(null!==(t=n.provider.icon)&&void 0!==t?t:h.XF).render(this._providerWidget.node))}_setText(e){const t=e.insertText,i=this._editor,n=this._model;if(!n||!i)return;const s=i.editor;this._ghostManager.placeGhost(s,{from:i.getOffsetAt(n.cursor),content:t,providerId:e.provider.identifier,addedPart:e.lastStreamed,streaming:e.streaming,onPointerOver:this._onPointerOverGhost.bind(this),onPointerLeave:this._onPointerLeaveGhost.bind(this)})}_onPointerOverGhost(){null!==this._clearHoverTimeout&&(window.clearTimeout(this._clearHoverTimeout),this._clearHoverTimeout=null),this.node.classList.add(P)}_onPointerLeaveGhost(){this._clearHoverTimeout=window.setTimeout((()=>this.node.classList.remove(P)),500)}_setGeometry(){const{node:e}=this,t=this._model,i=this._editor;if(!i||!t||!t.cursor)return;const n=i.host.closest(".jp-MainAreaWidget > .lm-Widget")||i.host;let s;try{s=i.getCoordinateForPosition(t.cursor)}catch(e){return void this.hide()}g.e.setGeometry({anchor:s,host:n,maxHeight:40,minHeight:20,node:e,privilege:"forceAbove",outOfViewDisplay:{top:"stick-outside",bottom:"stick-inside",left:"stick-inside",right:"stick-outside"}})}_updateShortcutsVisibility(){this.node.dataset.showShortcuts=this._showShortcuts+""}_updateDisplay(){this.node.dataset.display=this._showWidget}}!function(e){e.defaultSettings={showWidget:"onHover",showShortcuts:!0,streamingAnimation:"uncover",providers:{}},e.Model=class{constructor(){this.suggestionsChanged=new v.Signal(this),this.filterTextChanged=new v.Signal(this),this.provisionProgress=new v.Signal(this),this._isDisposed=!1,this._completions=null}setCompletions(e){var t,i;const n=new Map(null===(i=null===(t=this._completions)||void 0===t?void 0:t.items)||void 0===i?void 0:i.map(((e,t)=>[e.insertText,t])));this._completions=e;const s=new Map(e.items.map(((e,t)=>[n.get(e.insertText),t])));this.suggestionsChanged.emit({event:"set",indexMap:s})}appendCompletions(e){this._completions&&this._completions.items?(this._completions.items.push(...e.items),this.suggestionsChanged.emit({event:"append"})):console.warn("No completions to append to")}notifyProgress(e){this.provisionProgress.emit(e)}get cursor(){return this._cursor}set cursor(e){this._cursor=e}get completions(){return this._completions}reset(){this._completions=null,this.suggestionsChanged.emit({event:"clear"})}get isDisposed(){return this._isDisposed}handleTextChange(e){var t;const i=this._completions;if(!i||!i.items||0===i.items.length)return;const n=new Map(i.items.map(((e,t)=>[e,t])));for(let n of null!==(t=e.sourceChange)&&void 0!==t?t:[]){const e=n.insert;if(e){const t=i.items.filter((t=>{var i;const n=null!==(i=t.filterText)&&void 0!==i?i:t.insertText;return!!n.startsWith(e)&&(t.filterText=n.substring(e.length),t.insertText=t.insertText.substring(e.length),!0)}));0===t.length&&(this._completions=null),i.items=t}else n.retain||(this._completions=null)}const s=new Map(i.items.map(((e,t)=>[n.get(e),t])));this.filterTextChanged.emit(s)}handleSelectionChange(e){const t=this.cursor;if(!t)return;const{start:i,end:n}=e;i.column===n.column&&i.line===n.line||this.reset(),(i.line!==t.line||i.column<t.column)&&this.reset()}dispose(){this._isDisposed||(this._isDisposed=!0,v.Signal.clearData(this))}}}(k||(k={}));var I=i(89492),S=i(67004),T=i(62097),M=i(37706);class H{constructor(){this._activeProviders=new Set([d.c,r]),this._inlineCompleterSettings=k.defaultSettings,this._providers=new Map,this._inlineProviders=new Map,this._panelHandlers=new Map,this._mostRecentContext=new Map,this._activeProvidersChanged=new v.Signal(this),this._inlineCompleterFactory=null}get activeProvidersChanged(){return this._activeProvidersChanged}setTimeout(e){this._timeout=e}setShowDocumentationPanel(e){this._panelHandlers.forEach((t=>t.completer.showDocsPanel=e)),this._showDoc=e}setContinuousHinting(e){this._panelHandlers.forEach((t=>t.autoCompletion=e)),this._autoCompletion=e}registerProvider(e){const t=e.identifier;this._providers.has(t)?console.warn(`Completion provider with identifier ${t} is already registered`):(this._providers.set(t,e),this._panelHandlers.forEach(((e,t)=>{this.updateCompleter(this._mostRecentContext.get(t))})))}registerInlineProvider(e){const t=e.identifier;this._inlineProviders.has(t)?console.warn(`Completion provider with identifier ${t} is already registered`):(this._inlineProviders.set(t,e),this._panelHandlers.forEach(((e,t)=>{this.updateCompleter(this._mostRecentContext.get(t))})))}getProviders(){return this._providers}activateProvider(e){this._activeProviders=new Set([]),e.forEach((e=>{this._providers.has(e)&&this._activeProviders.add(e)})),0===this._activeProviders.size&&(this._activeProviders.add(d.c),this._activeProviders.add(r)),this._activeProvidersChanged.emit()}async updateCompleter(e){var t,i;const{widget:n,editor:s,sanitizer:o}=e,r=n.id,l=this._panelHandlers.get(r),a=[...this._activeProviders][0],d=this._providers.get(a);let c=null!==(t=null==d?void 0:d.renderer)&&void 0!==t?t:M.A.getDefaultRenderer(o);const h=null==d?void 0:d.modelFactory;let m;m=h?await h.call(d,e):new T.X,this._mostRecentContext.set(n.id,e);const u={model:m,editor:s,renderer:c,sanitizer:o,showDoc:this._showDoc};if(l){const t=l.completer;null===(i=t.model)||void 0===i||i.dispose(),t.model=u.model,t.renderer=u.renderer,t.showDocsPanel=u.showDoc,l.autoCompletion=this._autoCompletion,s&&(l.editor=s,l.reconciliator=await this.generateReconciliator(e))}else{const t=await this._generateHandler(e,u);this._panelHandlers.set(n.id,t),n.disposed.connect((e=>{this.disposeHandler(e.id,t),this._mostRecentContext.delete(r)}))}}invoke(e){const t=this._panelHandlers.get(e);t&&t.invoke()}select(e){const t=this._panelHandlers.get(e);t&&t.completer.selectActive()}setInlineCompleterFactory(e){this._inlineCompleterFactory=e,this._panelHandlers.forEach(((e,t)=>{this.updateCompleter(this._mostRecentContext.get(t))})),this.inline||(this.inline={invoke:e=>{const t=this._panelHandlers.get(e);t&&t.inlineCompleter&&t.invokeInline()},cycle:(e,t)=>{const i=this._panelHandlers.get(e);i&&i.inlineCompleter&&i.inlineCompleter.cycle(t)},accept:e=>{const t=this._panelHandlers.get(e);t&&t.inlineCompleter&&t.inlineCompleter.accept()},configure:e=>{this._inlineCompleterSettings=e,this._panelHandlers.forEach(((t,i)=>{for(const[t,i]of this._inlineProviders.entries())i.configure&&i.configure(e.providers[t]);t.inlineCompleter&&t.inlineCompleter.configure(e),this.updateCompleter(this._mostRecentContext.get(i))}))}})}get inlineProviders(){return[...this._inlineProviders.values()]}async generateReconciliator(e){const t=[];for(const[e,i]of Object.entries(this._inlineCompleterSettings.providers))!0===i.enabled&&t.push(e);const i=[...this._inlineProviders.values()].filter((e=>t.includes(e.identifier))),n=[];for(const e of this._activeProviders){const t=this._providers.get(e);t&&n.push(t)}return new I.C({context:e,providers:n,inlineProviders:i,inlineProvidersSettings:this._inlineCompleterSettings.providers,timeout:this._timeout})}disposeHandler(e,t){var i,n,s,o;null===(i=t.completer.model)||void 0===i||i.dispose(),t.completer.dispose(),null===(s=null===(n=t.inlineCompleter)||void 0===n?void 0:n.model)||void 0===s||s.dispose(),null===(o=t.inlineCompleter)||void 0===o||o.dispose(),t.dispose(),this._panelHandlers.delete(e)}async _generateHandler(e,t){const i=new M.A(t),n=this._inlineCompleterFactory?this._inlineCompleterFactory.factory({...t,model:new k.Model}):void 0;i.hide(),p.x0.attach(i,document.body),n&&(p.x0.attach(n,document.body),n.hide(),n.configure(this._inlineCompleterSettings));const s=await this.generateReconciliator(e),o=new S.$({completer:i,inlineCompleter:n,reconciliator:s});return o.editor=e.editor,o}}var E=i(69584),D=i(61110),A=i(16950),F=i(9387);const W="availableProviders";function O(e){const{schema:t}=e,i=t.title,n=t.description,s=e.formContext.settings,o=s.get(W).user,r={...t.default};if(o)for(const e of Object.keys(r))r[e]=e in o?o[e]:-1;const[l,a]=(0,F.useState)(r);return F.createElement("div",null,F.createElement("fieldset",null,F.createElement("legend",null,i),F.createElement("p",{className:"field-description"},n),Object.keys(r).map((e=>F.createElement("div",{key:e,className:"form-group small-field"},F.createElement("div",null,F.createElement("h3",null," ",e),F.createElement("div",{className:"inputFieldWrapper"},F.createElement("input",{className:"form-control",type:"number",value:l[e],onChange:t=>{((e,t)=>{const i={...l,[e]:parseInt(t.target.value)};s.set(W,i).catch(console.error),a(i)})(e,t)}}))))))))}const j="@jupyterlab/completer-extension:manager",L="@jupyterlab/completer-extension:inline-completer";var R;!function(e){e.nextInline="inline-completer:next",e.previousInline="inline-completer:previous",e.acceptInline="inline-completer:accept",e.invokeInline="inline-completer:invoke"}(R||(R={}));const B={id:"@jupyterlab/completer-extension:base-service",description:"Adds context and kernel completion providers.",requires:[o.qx],autoStart:!0,activate:(e,t)=>{t.registerProvider(new l),t.registerProvider(new d.G)}},G={id:"@jupyterlab/completer-extension:inline-history",description:"Adds inline completion provider suggesting code from execution history.",requires:[o.qx],optional:[c.sQ],autoStart:!0,activate:(e,t,i)=>{t.registerInlineProvider(new m({translator:null!=i?i:c.wK}))}},q={id:"@jupyterlab/completer-extension:inline-completer-factory",description:"Provides a factory for inline completer.",provides:o.CF,optional:[c.sQ],autoStart:!0,activate:(e,t)=>{const i=(t||c.wK).load("jupyterlab");return{factory:t=>{const n=new k({...t,trans:i}),o=t=>{const i=e.commands.keyBindings.find((e=>e.command===t)),n=i?A.J.formatKeystroke(i.keys):"";return n?`${n}`:""},r={[R.previousInline]:o(R.previousInline),[R.nextInline]:o(R.nextInline),[R.acceptInline]:o(R.acceptInline)};return e.commands.keyBindingChanged.connect(((t,i)=>{const n=i.binding.command;if(r.hasOwnProperty(n)){const t=r[n],i=o(n);i!==t&&(r[n]=i,e.commands.notifyCommandChanged(n))}})),n.toolbar.addItem("previous-inline-completion",new s.Fu({commands:e.commands,icon:h.SW,id:R.previousInline,label:()=>r[R.previousInline],caption:i.__("Previous")})),n.toolbar.addItem("next-inline-completion",new s.Fu({commands:e.commands,icon:h.XU,id:R.nextInline,label:()=>r[R.nextInline],caption:i.__("Next")})),n.toolbar.addItem("accept-inline-completion",new s.Fu({commands:e.commands,icon:h.oE,id:R.acceptInline,label:()=>r[R.acceptInline],caption:i.__("Accept")})),n.model.suggestionsChanged.connect((()=>{for(const t of[R.previousInline,R.nextInline,R.acceptInline])e.commands.notifyCommandChanged(t)})),n}}}},z={id:L,description:"Registers the inline completer factory; adds inline completer commands, shortcuts and settings.",requires:[o.qx,o.CF,E.X],optional:[c.sQ],autoStart:!0,activate:(e,t,i,s,o)=>{t.setInlineCompleterFactory(i);const r=(o||c.wK).load("jupyterlab"),l=()=>!!e.shell.currentWidget&&!!t.inline;let a;e.commands.addCommand(R.nextInline,{execute:()=>{var i;null===(i=t.inline)||void 0===i||i.cycle(e.shell.currentWidget.id,"next")},label:r.__("Next Inline Completion"),isEnabled:l}),e.commands.addCommand(R.previousInline,{execute:()=>{var i;null===(i=t.inline)||void 0===i||i.cycle(e.shell.currentWidget.id,"previous")},label:r.__("Previous Inline Completion"),isEnabled:l}),e.commands.addCommand(R.acceptInline,{execute:()=>{var i;null===(i=t.inline)||void 0===i||i.accept(e.shell.currentWidget.id)},label:r.__("Accept Inline Completion"),isEnabled:()=>l()&&t.inline.isActive(e.shell.currentWidget.id)}),e.commands.addCommand(R.invokeInline,{execute:()=>{var i;null===(i=t.inline)||void 0===i||i.invoke(e.shell.currentWidget.id)},label:r.__("Invoke Inline Completer"),isEnabled:l});const d=e=>{var i;a=e.composite,null===(i=t.inline)||void 0===i||i.configure(a)};e.restored.then((()=>{var e;const i=null!==(e=t.inlineProviders)&&void 0!==e?e:[],n=e=>{var t,i;return{enabled:!0,autoFillInMiddle:!1,timeout:5e3,debouncerDelay:0,...null!==(i=null===(t=e.schema)||void 0===t?void 0:t.default)&&void 0!==i?i:{}}};s.transform(L,{compose:e=>{var t,s;const o=null!==(t=e.data.composite.providers)&&void 0!==t?t:{};for(const e of i){const t=n(e);o[e.identifier]={...t,...null!==(s=o[e.identifier])&&void 0!==s?s:{}}}return e.data.composite.providers=o,e},fetch:e=>{var t,s;const o=e.schema.properties,l={};for(const e of i)l[e.identifier]={title:r.__("%1 provider",e.name),properties:{...null!==(s=null===(t=e.schema)||void 0===t?void 0:t.properties)&&void 0!==s?s:{},timeout:{title:r.__("Timeout"),description:r.__("Timeout for %1 provider (in milliseconds).",e.name),type:"number",minimum:0},debouncerDelay:{title:r.__("Debouncer delay"),minimum:0,description:r.__("Time since the last key press to wait before requesting completions from %1 provider (in milliseconds).",e.name),type:"number"},enabled:{title:r.__("Enabled"),description:r.__("Whether to fetch completions %1 provider.",e.name),type:"boolean"},autoFillInMiddle:{title:r.__("Fill in middle on typing"),description:r.__("Whether to show completions in the middle of the code line from %1 provider on typing.",e.name),type:"boolean"}},default:n(e),type:"object"};return o.providers.properties=l,e}}),s.load(L).then((e=>{d(e),e.changed.connect((e=>{d(e)}))})).catch(console.error)})).catch(console.error);const h=t=>e.commands.keyBindings.find((e=>e.command===t)),m={[R.acceptInline]:h(R.acceptInline),[R.invokeInline]:h(R.invokeInline)};e.commands.keyBindingChanged.connect(((e,t)=>{const i=t.binding.command;m.hasOwnProperty(i)&&(m[i]=h(i))})),document.addEventListener("keydown",(t=>{if(!(t.target instanceof Element))return;const i=t.target;switch(t.keyCode){case 9:{const s=[m[R.acceptInline],m[R.invokeInline]];for(const o of s)if(o&&1===o.keys.length&&"Tab"===o.keys[0]&&i.closest(o.selector)&&e.commands.isEnabled(o.command)){const s=i.closest("."+n.Qr);if((null==a?void 0:a.suppressIfTabCompleterActive)&&s)return;return e.commands.execute(o.command).catch(console.error),t.preventDefault(),t.stopPropagation(),void t.stopImmediatePropagation()}break}default:return}}),!0)}},N={id:j,description:"Provides the completion provider manager.",requires:[E.X],optional:[D.g],provides:o.qx,autoStart:!0,activate:(e,t,i)=>{const n="availableProviders",s=new H,o=(e,t)=>{var i;const o=e.get(n),r=e.composite;s.setTimeout(r.providerTimeout),s.setShowDocumentationPanel(r.showDocumentationPanel),s.setContinuousHinting(r.autoCompletion),s.setSuppressIfInlineCompleterActive(r.suppressIfInlineCompleterActive);const l=null!==(i=o.user)&&void 0!==i?i:o.composite,a=Object.entries(null!=l?l:{}).filter((e=>e[1]>=0&&t.includes(e[0]))).sort((([,e],[,t])=>t-e)).map((e=>e[0]));s.activateProvider(a)};if(e.restored.then((()=>{const e=[...s.getProviders().entries()],i=e.map((([e,t])=>e));t.transform(j,{fetch:t=>{const i=t.schema.properties,s={};return e.forEach((([e,t],i)=>{var n;s[e]=null!==(n=t.rank)&&void 0!==n?n:10*(i+1)})),i[n].default=s,t}}),t.load(j).then((e=>{o(e,i),e.changed.connect((e=>{o(e,i)}))})).catch(console.error)})).catch(console.error),i){const e={fieldRenderer:e=>O(e)};i.addRenderer(`${j}.availableProviders`,e)}return s}},$=[N,B,G,q,z]},60639:(e,t,i)=>{i.d(t,{e:()=>o});const n="jp-HoverBox",s="-1000";var o;!function(e){e.setGeometry=function(e){const{anchor:t,host:i,node:o,privilege:r,outOfViewDisplay:l}=e,a=i.getBoundingClientRect();o.classList.contains(n)||o.classList.add(n),o.style.visibility&&(o.style.visibility=""),""===o.style.zIndex&&(o.style.zIndex=""),o.style.maxHeight="",o.style.marginTop="";const d=e.style||window.getComputedStyle(o),c=t.top-a.top,h=a.bottom-t.bottom,m=parseInt(d.marginTop,10)||0,u=parseInt(d.marginLeft,10)||0,p=parseInt(d.minHeight,10)||e.minHeight;let v=parseInt(d.maxHeight,10)||e.maxHeight;const g="forceAbove"!==r&&("forceBelow"===r||("above"===r?c<v&&c<h:h>=v||h>=c));if(g?v=Math.min(h-m,v):(v=Math.min(c,v),o.style.marginTop="0px"),o.style.maxHeight=`${v}px`,!(v>=p&&(h>=p||c>=p)))return o.style.zIndex=s,void(o.style.visibility="hidden");e.size?(o.style.width=`${e.size.width}px`,o.style.height=`${e.size.height}px`,o.style.contain="strict"):(o.style.contain="",o.style.width="auto",o.style.height="");const f=e.size?e.size.height:o.getBoundingClientRect().height,_=e.offset&&e.offset.vertical&&e.offset.vertical.above||0,y=e.offset&&e.offset.vertical&&e.offset.vertical.below||0;let w=g?a.bottom-h+y:a.top+c-f+_;o.style.top=`${Math.floor(w)}px`;const x=e.offset&&e.offset.horizontal||0;let C=t.left+x;o.style.left=`${Math.ceil(C)}px`;let b=o.getBoundingClientRect(),P=b.right;P>window.innerWidth&&(C-=P-window.innerWidth,P=window.innerWidth,o.style.left=`${Math.ceil(C)}px`),C<x-u&&(C=x-u,o.style.left=`${Math.ceil(C)}px`),o.style.zIndex="-1000";const k=b.bottom,I=i.contains(document.elementFromPoint(C,w)),S=i.contains(document.elementFromPoint(P,w)),T=i.contains(document.elementFromPoint(P,k)),M=i.contains(document.elementFromPoint(C,k));o.style.zIndex="";const H=I||S,E=M||T,D=I||M,A=T||S,F=k-w,W=P-C,O=w<a.top,j=k>a.bottom,L=C+u<a.left,R=P>a.right;let B=!1,G=!1,q=!1;if(O)switch((null==l?void 0:l.top)||"hidden-inside"){case"hidden-inside":H||(B=!0);break;case"hidden-outside":E||(B=!0);break;case"stick-inside":a.top>w&&(w=a.top,q=!0);break;case"stick-outside":a.top>k&&(w=a.top-F,q=!0)}if(j)switch((null==l?void 0:l.bottom)||"hidden-outside"){case"hidden-inside":E||(B=!0);break;case"hidden-outside":H||(B=!0);break;case"stick-inside":a.bottom<k&&(w=a.bottom-F,q=!0);break;case"stick-outside":a.bottom<w&&(w=a.bottom,q=!0)}if(L)switch((null==l?void 0:l.left)||"hidden-inside"){case"hidden-inside":D||(B=!0);break;case"hidden-outside":A||(B=!0);break;case"stick-inside":a.left>C+u&&(C=a.left-u,G=!0);break;case"stick-outside":a.left>P&&(C=a.left-u-W,G=!0)}if(R)switch((null==l?void 0:l.right)||"hidden-outside"){case"hidden-inside":A||(B=!0);break;case"hidden-outside":D||(B=!0);break;case"stick-inside":a.right<P&&(C=a.right-W,G=!0);break;case"stick-outside":a.right<C&&(C=a.right,G=!0)}B&&(o.style.zIndex=s,o.style.visibility="hidden"),G&&(o.style.left=`${Math.ceil(C)}px`),q&&(o.style.top=`${Math.ceil(w)}px`)}}(o||(o={}))},61110:(e,t,i)=>{i.d(t,{J:()=>o,g:()=>s});var n=i(98238);const s=new n.Token("@jupyterlab/ui-components:IFormRendererRegistry","A service for settings form renderer registration."),o=new n.Token("@jupyterlab/ui-components:ILabIconManager","A service to register and request icons.")}}]);