"use strict";(self.webpackChunk_datalayer_ui=self.webpackChunk_datalayer_ui||[]).push([[5388],{46916:(e,s,n)=>{n.d(s,{E:()=>o});var t=n(71791),i=n(99180),a=n(38621),r=n(9387),l=n(18683);function o(e){const{commandRegistry:s,kernelDesc:n,save:o,sessionConnection:c}=e,[d,u]=(0,r.useState)();return(0,r.useEffect)((()=>{const e=()=>{u(c?.kernel?.status)};return e(),c?.statusChanged.connect(e),c?.connectionStatusChanged.connect(e),()=>{c?.statusChanged.disconnect(e),c?.connectionStatusChanged.disconnect(e)}}),[c]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i.Q,{variant:"invisible",size:"small",leadingVisual:a.iKr,disabled:void 0===n?.location,onClick:o,children:"Save"}),(0,l.jsx)(i.Q,{variant:"invisible",size:"small",leadingVisual:a.udU,disabled:!n?.location||"busy"===d,onClick:e=>{s?.execute(t.nx.runAll)},children:"Run all"}),(0,l.jsx)(i.Q,{variant:"invisible",size:"small",leadingVisual:a.wFz,disabled:!n?.location||"busy"!==d,onClick:e=>{s?.execute(t.nx.interrupt)},children:"Interrupt"})]})}},15388:(e,s,n)=>{n.r(s),n.d(s,{AssignmentEdit:()=>E,default:()=>R});var t=n(9387),i=n(20568),a=n(79026),r=n(97096),l=n(98754),o=n(8586),c=n(14722),d=n(99180),u=n(15824),h=n(88996),m=n(48371),g=n(64664),p=n(31906),x=n(18738),v=n(38621),f=n(85383),y=n(16476),j=n(2159),k=n(84271),A=n(86218),b=n(17810),S=n(23530),C=n(53850),w=n(97734),N=n(50906),B=n(54520),V=n(46916),z=n(18683);const E=()=>{const{assignmentId:e}=(0,i.g)();if(!e)return(0,z.jsx)(z.Fragment,{});const s=(0,b.J)(),n=(0,a.S)(),E=(0,S.Z)(),R=(0,N.mt)(),I=(0,y.Gx)(),L=(0,B.OK)(),Q=R.layout().space,_=L.saveRequest,D=I.selectNotebookModel(e),{cloneAssignment:F,getAssignment:O,getAssignmentStudentVersion:T,refreshAssignment:J,updateNotebookModel:M,updateNotebook:U}=(0,C.E)(),{enqueueToast:P}=(0,w.d)(),[$,q]=(0,t.useState)("editor"),[G,H]=(0,t.useState)(!1),[K,Z]=(0,t.useState)(void 0),[W,X]=(0,t.useState)([]),[Y,ee]=(0,t.useState)(),[se,ne]=(0,t.useState)({name:"",description:""}),[te,ie]=(0,t.useState)({name:void 0,description:void 0}),ae=(0,t.useMemo)((()=>[new j._]),[]),re=(0,t.useMemo)((()=>[new j._({factory:k.a})]),[]),le=(e,s)=>{s.preventDefault(),R.layout().resetRightPortal(),X([]),q(e)};(0,t.useEffect)((()=>{if(e&&"editor"===$)return R.layout().showBackdrop("Loading the assignment..."),J(e).then((s=>{if(s.success){const s=O(e);s?(ee(s),R.layout().setItem(s),ne({name:s.name,description:s.description})):E("/")}})).finally((()=>{R.layout().hideBackdrop()})),()=>{I.reset(),R.layout().setItem(void 0)}}),[e,$]);const oe=()=>{D?.model?.cells&&(R.layout().showBackdrop("Saving the assignment..."),M(e,D.model.toJSON()).then((e=>{e.success&&(P("The assignment is successfully updated.",{variant:"success"}),R.layout().triggerItemsRefresh(),ee({...Y,nbformat:D.model.toJSON()}))})).finally((()=>{R.layout().hideBackdrop()})))},ce=s=>{D?.model?.cells&&(s.preventDefault(),R.layout().showBackdrop("Generating the student version of the assignment..."),M(e,D.model.toJSON()),T(e).then((e=>{H(!0),le("student",s),e.success?Z(JSON.parse(e.notebook)):e.errors&&X(e.errors)})).finally((()=>{R.layout().hideBackdrop()})))};(0,t.useEffect)((()=>{_&&Y&&oe()}),[_]),(0,t.useEffect)((()=>{ie({...te,name:void 0===se.name?void 0:se.name.length>2,description:void 0===se.description?void 0:se.description.length>2})}),[se]);const de=(0,t.useCallback)((async t=>{n({title:"Are you sure?",content:"Please confirm you want to clone this assignment in your private library."}).then((n=>{n&&(R.layout().showBackdrop(),F(e).then((e=>{e.success&&(P(e.message,{variant:"success"}),R.layout().triggerItemsRefresh(),E(`/${s?.handle}/library/assignments`))})).finally((()=>{R.layout().hideBackdrop()})))}))}),[n,Y]);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(r.z,{children:(0,z.jsxs)(l.A,{display:"flex",children:[(0,z.jsx)(l.A,{flex:1,children:(0,z.jsx)(o.A,{sx:{fontSize:3},children:"Assignment editor"})}),"student"!==$&&(0,z.jsxs)(l.A,{display:"flex",children:[(0,z.jsx)(V.E,{commandRegistry:I.selectNotebookAdapter(e)?.commands,save:oe}),(0,z.jsx)(c.A,{children:(0,z.jsx)(d.Q,{variant:"invisible",size:"small",leadingVisual:f.A,onClick:e=>ce(e),children:"Student version"})}),Y&&Q&&(0,z.jsx)(d.Q,{variant:"invisible",size:"small",leadingVisual:v.Nc$,onClick:de,children:"Clone"})]})]})}),Y&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)(u.A,{sx:{mt:3,mb:3},children:[(0,z.jsx)(u.A.Link,{href:"",selected:"editor"===$,onClick:e=>le("editor",e),children:"Editor"}),(0,z.jsx)(u.A.Link,{href:"",selected:"properties"===$,onClick:e=>le("properties",e),children:"Properties"}),(0,z.jsx)(u.A.Link,{href:"",selected:"student"===$,onClick:e=>ce(e),children:"Student version"})]}),"editor"===$&&(0,z.jsx)(l.A,{children:Y.nbformat&&(0,z.jsx)(A.g,{id:e,height:"calc(100vh - 240px)",maxHeight:"calc(100vh - 240px)",nbformat:Y.nbformat,extensions:ae,cellSidebarMargin:200})}),"properties"===$&&(0,z.jsx)(l.A,{display:"grid",gridTemplateColumns:"1fr 1fr",children:(0,z.jsx)(l.A,{children:(0,z.jsxs)(l.A,{sx:{label:{marginTop:2}},children:[(0,z.jsxs)(h.A,{children:[(0,z.jsx)(h.A.Label,{children:"Name"}),(0,z.jsx)(m.A,{block:!0,value:se.name,onChange:e=>{ne((s=>({...s,name:e.target.value})))}}),!1===te.name&&(0,z.jsx)(h.A.Validation,{variant:"error",children:"Name must have more than 2 characters."})]}),(0,z.jsxs)(h.A,{children:[(0,z.jsx)(h.A.Label,{children:"Description"}),(0,z.jsx)(g.Ay,{block:!0,value:se.description,onChange:e=>{ne((s=>({...s,description:e.target.value})))}}),!1===te.description&&(0,z.jsx)(h.A.Validation,{variant:"error",children:"Description must have more than 2 characters."})]}),(0,z.jsx)(h.A,{children:(0,z.jsx)(d.Q,{variant:"primary",disabled:!te.name||!te.description,sx:{marginTop:2},onClick:async()=>{R.layout().showBackdrop("Updating assignment..."),U(e,se.name,se.description).then((e=>{e.success&&(P("The assignment is successfully updated.",{variant:"success"}),R.layout().triggerItemsRefresh(),ee({...Y,name:se.name,description:se.description}))})).finally((()=>{R.layout().hideBackdrop()}))},children:"Update assignment"})})]})})}),"student"===$&&(0,z.jsxs)(l.A,{ml:3,mr:3,children:[(0,z.jsx)(p.A,{variant:"warning",children:"Student version of the assignment."}),W.map((e=>(0,z.jsxs)(p.A,{variant:"danger",children:[(0,z.jsx)(x.A,{icon:v._0O}),e]}))),K&&0===W.length&&(0,z.jsx)(A.g,{id:`${e}-student`,height:"calc(100vh - 240px)",maxHeight:"calc(100vh - 240px)",nbformat:K,readonly:!0,extensions:re})]})]})]})},R=E},84271:(e,s,n)=>{n.d(s,{a:()=>c});var t=n(18683),i=n(38621),a=n(98754),r=n(99180),l=n(71791),o=n(84604);function c(e){const{commands:s}=e;return(0,t.jsx)(a.A,{className:o.VL,sx:{"& p":{marginBottom:"0 !important"}},children:(0,t.jsx)(r.Q,{trailingVisual:i.udU,size:"small",variant:"invisible",onClick:e=>{e.preventDefault(),s.execute(l.nx.run).catch((e=>{console.error("Failed to run cell.",e)}))},children:"Run"})})}}}]);