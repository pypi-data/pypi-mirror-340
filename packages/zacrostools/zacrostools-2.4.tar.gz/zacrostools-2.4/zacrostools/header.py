from pathlib import Path
from typing import Union
from . import __version__


def write_header(path: Union[str, Path]):
    """Write the header for the new Zacros input file.

    Parameters
    ----------
    path: Union[str, Path]
        Path of the input file where the header will be written.

    Raises
    ------
    IOError
        If the file cannot be opened for writing.
    """
    line_width = 80  # Fixed width for each header line

    try:
        path = Path(path)
        with path.open('w') as infile:
            # Header Line
            header_line = '#' * line_width
            infile.write(header_line + '\n')

            # Line 2: Zacros input file generated by ZacrosTools with version
            content_line_2 = f"#  Zacros input file generated by ZacrosTools (version {__version__})"
            padding_2 = line_width - len(content_line_2) - 1  # -1 for the closing '#'
            padding_2 = max(padding_2, 1)  # Ensure at least one space
            infile.write(f"{content_line_2}{' ' * padding_2}#\n")

            # Line 3: GitHub URL
            content_line_3 = "#  https://github.com/hprats/ZacrosTools"
            padding_3 = line_width - len(content_line_3) - 1  # -1 for the closing '#'
            padding_3 = max(padding_3, 1)
            infile.write(f"{content_line_3}{' ' * padding_3}#\n")

            # Line 4: Empty line within header
            content_line_4 = "#"
            padding_4 = line_width - len(content_line_4) - 1  # -1 for the closing '#'
            infile.write(f"{content_line_4}{' ' * padding_4}#\n")

            # Line 5: Author Information
            content_line_5 = "#  Hector Prats, PhD"
            padding_5 = line_width - len(content_line_5) - 1  # -1 for the closing '#'
            padding_5 = max(padding_5, 1)
            infile.write(f"{content_line_5}{' ' * padding_5}#\n")

            # Closing Header Line
            infile.write(header_line + '\n\n')
    except IOError as e:
        raise IOError(f"Failed to write header to '{path}': {e}")
